(()=>{var u=class a{static triggerEvent=function(t,e){if(document.createEvent){let n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),n.eventName=e,t.dispatchEvent(n)}else{let n=document.createEventObject();n.eventName=e,n.eventType=e,t.fireEvent(n.eventType,n)}};static getArray=function(t,e,n="/"){let i=a.ltrim(t,n).split(n),r=e;for(let s in i)if(Object.prototype.hasOwnProperty.call(i,s)){if(typeof r>"u"||!Object.prototype.hasOwnProperty.call(r,i[s]))return null;r=r[i[s]]}return r};static trim=function(t,e=" "){return a.ltrim(a.rtrim(t,e),e)};static rtrim=function(t,e=" "){return t.replace(new RegExp("["+e+"]*$"),"")};static ltrim=function(t,e=" "){return t.replace(new RegExp("^["+e+"]*"),"")};static htmlspecialchars=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"]];static htmlspecialchars_encode=function(t){let e=t,n=a.htmlspecialchars.length;for(let i=0;i<n;++i)e=e.replace(new RegExp(a.htmlspecialchars[i][0],"g"),a.htmlspecialchars[i][1]);return e};static htmlspecialchars_decode=function(t){let e=t,n=a.htmlspecialchars.length;for(let i=0;i<n;++i)e=e.replace(new RegExp(a.htmlspecialchars[i][1],"g"),a.htmlspecialchars[i][0]);return e};static substr_count=function(t,e){if(t+="",e+="",e.length<=0)return t.length+1;let n=0,i=0,r=e.length;for(;i=t.indexOf(e,i),i>=0;)++n,i+=r;return n};static hasClass=function(t,e){return typeof t<"u"&&t!==null&&(typeof t.className=="string"&&t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))!==null||typeof t.className.baseVal=="string"&&t.className.baseVal.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))!==null)};static addClass=function(t,e){a.hasClass(t,e)||(typeof t.className=="string"?t.className+=t.className!==""?" "+e:e:typeof t.className.baseVal=="string"&&(t.className.baseVal+=t.className.baseVal!==""?" "+e:e))};static removeClass=function(t,e){if(a.hasClass(t,e)){let n=new RegExp("(\\s|^)"+e);typeof t.className=="string"?t.className=t.className.replace(n,"").trim():typeof t.className.baseVal=="string"&&(t.className.baseVal=t.className.baseVal.replace(n,"").trim())}};static watcher=function(){let t=0;return function(e,n){clearTimeout(t),t=setTimeout(e,n)}}();static preventAll=function(t){return t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation(),t.cancelBubble=!0,!1};static ready=function(t){document.readyState==="complete"||document.readyState==="loaded"||document.readyState==="interactive"?t():document.addEventListener("DOMContentLoaded",function(e){t()})};static getValue=function(t){switch(t.tagName.toLowerCase()){case"div":case"pre":case"article":case"section":return t.innerHTML;default:return t.value}};static empty=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)};static hash=function(t){let e=0,n=t.length;for(let i=0;i<n;++i)e=e*31+t.charCodeAt(i);return e};static isNode=function(t){return typeof Node=="object"?t instanceof Node:t&&typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"};static isElement=function(t){return typeof HTMLElement=="object"?t instanceof HTMLElement:t&&typeof t=="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName=="string"};static getByClass=function(t,e){let n=t.childNodes.length;for(let i=0;i<n;++i)if(a.hasClass(t.childNodes[i],e))return t.childNodes[i];return null};static addEventListenerToAll=function(t,e,n){let i=t.length;for(let r=0;r<i;++r)t[r].addEventListener(e,n)};static isValidJson=function(t){try{JSON.parse(t)}catch{return!1}return!0};static merge=function(t,e){let n=a.clone(t);for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&typeof e[i]=="object"?n[i]=a.merge(n[i],e[i]):n[i]=e[i];return n};static clone=function(t){return{...t}};static isset=function(t){return typeof t<"u"&&t!==null};static strpbrk=function(t,e){let n=e.length,i=t.length,r=t.length;for(let s=0;s<n;++s)(i=t.indexOf(e.charAt(s)))>=0&&r>i&&(r=i);return t.slice(r)}};var K=class{constructor(){this.assets={},this.registerLoadedAssets()}registerLoadedAssets(){if(this.assets={},typeof document>"u")return;let t=document.getElementsByTagName("script"),e=t?t.length:0;for(let n=0;n<e;++n)this.assets[u.hash(t[n].src)]=t[n].src}load(t,e,n){let i;if(!this.assets[i=u.hash(t)]){let r=null;if(e==="js"){if(r=document.createElement("script"),r.setAttribute("type","text/javascript"),r.setAttribute("src",t),typeof r<"u"){let s=document.getElementsByTagName("head");s&&s[0].appendChild(r)}this.assets[i]=t}else if(e==="css"){if(r=document.createElement("link"),r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href",t),typeof r<"u"){let s=document.getElementsByTagName("head");s&&s[0].appendChild(r)}this.assets[i]=t}else e==="img"&&(this.assets[i]=new Image,this.assets[i].src=t);return n&&(r.onreadystatechange=function(){this.readyState==="complete"&&n()},r.onload=n()),i}return!1}get(t){return t=u.hash(t),this.assets[t]?this.assets[t]:null}remove(t){return t=u.hash(t),typeof this.assets[t]<"u"?(delete this.assets[t],!0):!1}};var q=Object.freeze({EMERGENCY:"emergency",ALERT:"alert",CRITICAL:"critical",ERROR:"error",WARNING:"warning",NOTICE:"notice",INFO:"info",DEBUG:"debug"});var k=class a{constructor(t){this.uri="",this.scheme="",this.host="",this.port="",this.user="",this.pass="",this.query=null,this.queryString="",this.fragment="",this.base="",this.root="/",this.set(t)}static parseUrl(t,e="php"){let n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],i={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};if(!Object.prototype.hasOwnProperty.call(i,e))throw new Error("Unexpected parsing mode.","UriFactory",52);let r=i[e].exec(t),s={},o=14;for(;--o;)r[o]&&(s[n[o]]=r[o]);return delete s.source,s}static getUriQueryParameter(t,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");let i=new RegExp("[\\?&]*"+e+"=([^&#]*)").exec(t);return i===null?"":decodeURIComponent(i[1].replace(/\+/g," "))}static getAllUriQueryParameters(t){let e={},n=[],i=null;if(t.length){n=t.split("&");for(i in n){if(!Object.prototype.hasOwnProperty.call(n,i))continue;let r=n[i].split("=")[0];r.length&&(typeof e[r]>"u"&&(e[r]=[]),e[r].push(n[i].split("=")[1]))}}return e}set(t){this.uri=t;let e=a.parseUrl(this.uri,"php");this.scheme=e.scheme,this.host=e.host,this.port=e.port,this.user=e.user,this.pass=e.pass,this.path=e.path,this.path.endsWith(".php")&&(this.path=this.path.substr(0,-4)),this.queryString=typeof e.query<"u"?e.query:[],this.queryString!==null&&(this.query=a.getAllUriQueryParameters(this.queryString)),this.fragment=typeof e.fragment<"u"?e.fragment:"",this.base=this.scheme+"://"+this.host+this.root}setRootPath(t){this.root=t,this.set(this.uri)}getRootPath(){return this.root}getBase(){return this.base}getScheme(){return this.scheme}getHost(){return this.host}getPort(){return this.port}getUser(){return this.user}getPass(){return this.pass}getQuery(){return this.queryString}getUri(){return this.uri}getFragment(){return this.fragment}getPath(){return this.path}getPathOffset(){return u.substr_count(this.root,"/")-1}};var F=class a{constructor(t){this.id=t,this.success=null,this.finally=null,this.lastSubmit=0,this.form=null,this.submitInjects=[],this.method="POST",this.action="",this.hasChanges=!1,this.bind()}initializeMembers(){this.submitInjects=[],this.method="POST",this.action=""}getMethod(){return this.method}getAction(){return this.action}getLastSubmit(){return this.lastSubmit}updateLastSubmit(){this.lastSubmit=Math.floor(Date.now())}isOnChange(){let t=this.getFormElement().getAttribute("data-on-change");return t==="true"||t==="1"}getSubmit(t=null){return(t===null?document:t).querySelectorAll("#"+this.id+" input[type=submit], button[form="+this.id+"][type=submit], input[form="+this.id+"][type=submit], #"+this.id+" button[type=submit], .submit[data-form="+this.id+"], #"+this.id+" .submit"+(t!==null?"  .submit":""))}getImagePreviews(){return document.querySelectorAll("#"+this.id+" input[type=file].preview")}getUpdate(t=null){return(t===null?document:t).querySelectorAll("button[form="+this.id+"].update-form, .update-form[data-form="+this.id+"], #"+this.id+' .update-form, [form="'+this.id+'"].update-form'+(t!==null?", .update-form":""))}getSave(t=null){return(t===null?document:t).querySelectorAll("button[form="+this.id+"].save-form, .save-form[data-form="+this.id+"], #"+this.id+' .save-form, [form="'+this.id+'"].save-form'+(t!==null?", .save-form":""))}getCancel(t=null){return(t===null?document:t).querySelectorAll("#"+this.id+" input[type=reset], button[form="+this.id+"][type=reset], input[form="+this.id+"][type=reset], #"+this.id+" button[type=reset], button[form="+this.id+"].cancel-form, .cancel-form[data-form="+this.id+"], #"+this.id+' .cancel-form, [form="'+this.id+'"].cancel-form'+(t!==null?", .cancel-form":""))}getRemove(t=null){return(t===null?document:t).querySelectorAll("button[form="+this.id+"].remove-form, .remove-form[data-form="+this.id+"], #"+this.id+' .remove-form, [form="'+this.id+'"].remove-form'+(t!==null?", .remove-form":""))}getAdd(t=null){return(t===null?document:t).querySelectorAll("button[form="+this.id+"].add-form, .add-form[data-form="+this.id+"], #"+this.id+' .add-form, [form="'+this.id+'"].add-form'+(t!==null?", .add-form":""))}getSuccess(){return this.success}setSuccess(t){this.success=t}getFinally(){return this.finally}setFinally(t){this.finally=t}injectSubmit(t){this.submitInjects.push(t)}getFormElements(t=null){let e=t===null?this.getFormElement():t;if(!e)return[];let n=e.getElementsByTagName("select"),i=e.getElementsByTagName("textarea"),r=[].slice.call(e.getElementsByTagName("input")),s=e.getElementsByTagName("button"),o=e.getElementsByTagName("canvas"),l=[].slice.call(document.querySelectorAll(":not(#"+this.id+") [form="+this.id+"]")),c=e.querySelectorAll("[data-name]"),d=document.querySelectorAll(":not(#"+this.id+") [data-form="+this.id+"]"),p=r.length,f=l.length,h=d.length;for(let m=0;m<p;++m)(r[m]===void 0||typeof r[m]<"u"&&(r[m].type==="checkbox"||r[m].type==="radio")&&!r[m].checked)&&delete r[m];for(let m=0;m<f;++m){if(l[m]===void 0||typeof l[m]<"u"&&e.contains(l[m])){delete l[m];continue}(l[m]===void 0||typeof l[m]<"u"&&(l[m].type==="checkbox"||l[m].type==="radio")&&!l[m].checked)&&delete l[m]}for(let m=0;m<h;++m)if(d[m]===void 0||typeof d[m]<"u"&&e.contains(d[m])){delete d[m];continue}return Array.prototype.slice.call(r).concat(Array.prototype.slice.call(n),Array.prototype.slice.call(i),Array.prototype.slice.call(s),Array.prototype.slice.call(l),Array.prototype.slice.call(c),Array.prototype.slice.call(d),Array.prototype.slice.call(o)).filter(function(m){return m})}getFirstInputElement(t=null){return(t===null?document:t).querySelector("#"+this.id+" input, #"+this.id+" textarea, #"+this.id+" select, [form="+this.id+"], [data-form="+this.id+"]")}getUniqueFormElements(t){let e={};return t.filter(function(n){return Object.prototype.hasOwnProperty.call(e,n.name)?!1:e[n.name]=!0})}getData(t=null){let e={},n=new FormData,i=this.getFormElements(t),r=i.length,s=null;for(let o=0;o<r;++o){let l=a.getElementId(i[o]);if(l!==null){if(i[o].tagName.toLowerCase()==="canvas")s=i[o].toDataURL("image/png");else if(i[o].tagName.toLowerCase()==="input"&&i[o].type==="file"){let c=i[o].files.length;for(let d=0;d<c;++d)n.append(l+d,i[o].files[d])}else if(i[o].tagName.toLowerCase()==="iframe"){let c=Array.prototype.slice.call(i[o].contentWindow.document.querySelectorAll("[form="+this.id+"]")).concat(Array.prototype.slice.call(i[o].contentWindow.document.querySelectorAll("[data-form="+this.id+"] [data-name]"))).filter(function(p){return p}),d=c.length;for(let p=0;p<d;++p){s=c[p].value;let f=a.getElementId(c[p]);Object.prototype.hasOwnProperty.call(e,f)?(e[f].constructor!==Array&&(e[f]=[e[f]]),e[f].push(s)):e[f]=s}continue}else typeof i[o].value<"u"?s=i[o].value:i[o].getAttribute("data-value")!==null?s=i[o].getAttribute("data-value"):s=i[o].innerHTML;Object.prototype.hasOwnProperty.call(e,l)?(e[l].constructor!==Array&&(e[l]=[e[l]]),e[l].push(s)):e[l]=s}}for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.append(o,e[o]!==null&&e[o].constructor===Array?JSON.stringify(e[o]):e[o]);return n}resetValues(){let t=this.getFormElements(),e=t.length;this.getFormElement().reset();for(let i=0;i<e;++i)a.getElementId(t[i])!==null&&(t[i].tagName.toLowerCase()==="canvas"?t[i].clearRect(0,0,t[i].width,t[i].height):t[i].tagName.toLowerCase()==="textarea"&&(t[i].innerHTML=""),t[i].getAttribute("data-value")!==null&&t[i].setAttribute("data-value",""),t[i].getAttribute("data-name")!==null&&(t[i].innerHTML=""))}getId(){return this.id}getFormElement(){return this.form===null?this.form=document.getElementById(this.id):this.form}isValid(t=null){let e=t===null?this.getFormElements():t,n=e.length;try{for(let i=0;i<n;++i)if(!(!e[i].required&&e[i].value==="")&&(e[i].required&&e[i].value===""||e[i].required&&e[i].getAttribute("type")==="checkbox"&&!e[i].checked||typeof e[i].pattern<"u"&&e[i].pattern!==""&&!new RegExp(e[i].pattern).test(e[i].value)||typeof e[i].maxlength<"u"&&e[i].maxlength!==""&&e[i].value.length>e[i].maxlength||typeof e[i].minlength<"u"&&e[i].minlength!==""&&e[i].value.length<e[i].minlength||typeof e[i].max<"u"&&e[i].max!==""&&e[i].value>e[i].max||typeof e[i].min<"u"&&e[i].min!==""&&e[i].value<e[i].min))return!1}catch(i){u.Log.Logger.instance.error(i)}return!0}getInvalid(t=null){let e=t===null?this.getFormElements():t,n=e.length,i=[];try{for(let r=0;r<n;++r)(e[r].required&&e[r].value===""||typeof e[r].pattern<"u"&&e[r].pattern!==""&&!new RegExp(e[r].pattern).test(e[r].value)||typeof e[r].maxlength<"u"&&e[r].maxlength!==""&&e[r].value.length>e[r].maxlength||typeof e[r].minlength<"u"&&e[r].minlength!==""&&e[r].value.length<e[r].minlength||typeof e[r].max<"u"&&e[r].max!==""&&e[r].value>e[r].max||typeof e[r].min<"u"&&e[r].min!==""&&e[r].value<e[r].min)&&i.push(e[r])}catch(r){u.Log.Logger.instance.error(r)}return i}static getElementId(t){return t.getAttribute("name")!==null?t.getAttribute("name"):t.getAttribute("data-name")!==null?t.getAttribute("data-name"):t.getAttribute("id")!==null?t.getAttribute("id"):t.getAttribute("type")!==null?t.getAttribute("type"):null}getSubmitInjects(){return this.submitInjects}bind(){this.clean(),this.form=this.getFormElement(),this.form!==null&&(typeof this.form.attributes.method<"u"?this.method=this.form.attributes.method.value:typeof this.form.attributes["data-method"]<"u"?this.method=this.form.attributes["data-method"].value:this.method="EMPTY",typeof this.form.attributes.action<"u"?this.action=this.form.attributes.action.value:typeof this.form.attributes["data-uri"]<"u"?this.action=this.form.attributes["data-uri"].value:this.action="EMPTY")}getElementsToBind(t=null){let n=(t===null?document:t).querySelectorAll("[form="+this.id+"]");return Array.prototype.slice.call(n).concat(Array.prototype.slice.call([this.form])).filter(function(i){return i})}clean(){this.initializeMembers()}};var S=class a{static setQuery(t,e,n=!0){return n||!Object.prototype.hasOwnProperty.call(a.uri,t)?(a.uri[t]=e,!0):!1}static getQuery(t){return Object.prototype.hasOwnProperty.call(a.uri,t)?a.uri[t]:null}static clearAll(){return a.uri={},!0}static clear(t){return Object.prototype.hasOwnProperty.call(a.uri,t)?(delete a.uri[t],!0):!1}static clearLike(t){let e=!1,n=new RegExp(t);for(let i in a.uri)Object.prototype.hasOwnProperty.call(a.uri,i)&&n.test(i)&&(delete a.uri[i],e=!0);return e}static unique(t){let e=k.parseUrl(t),n=[];if(t.includes("?")){let r=typeof e.query>"u"?[]:e.query.replace(/\?/g,"&").split("&"),s={},o=r.length,l=null;if((typeof e.fragment>"u"||e.fragment===null)&&r[o-1].includes("#")){let c=r[o-1].split("#")[1];e.fragment=c[1],r[o-1]=c[0]}for(let c=0;c<o;++c)l=r[c].split("="),s[l[0]]=l.length<2?"":l[1];for(let c in s)Object.prototype.hasOwnProperty.call(s,c)&&s[c]!==""&&s[c]!==null&&typeof s[c]<"u"?n.push(c+"="+(s[c].includes("%")?s[c]:encodeURIComponent(s[c]))):Object.prototype.hasOwnProperty.call(s,c)&&n.push(c)}let i=typeof e.fragment<"u"?e.fragment.split("#"):null;return t=(typeof e.scheme<"u"?e.scheme+"://":"")+(typeof e.username<"u"?e.username+":":"")+(typeof e.password<"u"?e.password+"@":"")+(typeof e.host<"u"?e.host:"")+(typeof e.port<"u"?":"+e.port:"")+(typeof e.path<"u"?e.path:"")+(typeof e.query<"u"?"?"+n.join("&"):"")+(typeof e.fragment<"u"?"#"+i[i.length-1]:""),t}static buildAbsolute(t,e=null){return t.startsWith("/")?a.build(window.location.origin+t,e):t.indexOf("://")===-1?a.build(window.location.origin+"/"+t,e):t}static build(t,e=null){let n=typeof window>"u"?"":k.parseUrl(window.location.href),i=k.getAllUriQueryParameters(typeof n.query>"u"?{}:n.query);for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&a.setQuery("?"+s,i[s]);let r=t.replace(new RegExp("{[/#?%@\xB0.$!].*?}","g"),function(s){if(s=s.substring(1,s.length-1),e!==null&&(Object.prototype.hasOwnProperty.call(e,s)||s.includes("/")))return typeof e[s]>"u"&&s.includes("/")?u.getArray(s,e):e[s];if(typeof a.uri[s]<"u")return a.uri[s];if(s.indexOf("!")===0){let c=document.querySelector(s.substring(1));if(!c)return"";if(c.tagName.toLowerCase()!=="form")return c.value;let d="",p=new F(c.id).getData();for(let f of p.entries())d+="&"+f[0]+"="+f[1];return d}else{if(s.indexOf("?")===0)return k.getUriQueryParameter(n.query,s.substring(1));if(s==="#")return n.fragment;if(s.indexOf("#")===0){let c=document.getElementById(s.substring(1));if(c){if(c.tagName.toLowerCase()!=="form")return c.value;let d="",p=new F(c.id).getData();for(let f of p.entries())d+="&"+f[0]+"="+f[1];return d}return""}else{if(s.indexOf("?")===0&&s.length===1)return n.query();if(s.indexOf("/")===0&&s.length===1)return n.path;if(s.indexOf("\xB0")===0&&s.length===1){if(!navigator.geolocation)return;var o=0,l=0;return navigator.geolocation.getCurrentPosition(c=>{o=c.coords.latitude,l=c.coords.longitude}),o===0&&l===0?"":o+","+l}else return s.indexOf(":user")===0?n.user:s.indexOf(":pass")===0?n.pass:s.indexOf("/")===0?"ERROR%20PATH":s==="%"?typeof window>"u"?"":window.location.href:s}}});return r.indexOf("?")===-1&&(r=r.replace("&","?")),a.unique(r)}static setupUriBuilder(t){a.setQuery("/scheme",t.getScheme()),a.setQuery("/host",t.getHost()),a.setQuery("/base",u.rtrim(t.getBase(),"/"))}};S.uri={};var R=Object.freeze({POST:"POST",GET:"GET",PUT:"PUT",DELETE:"DELETE",HEAD:"HEAD"});var L=Object.freeze({JSON:"json",RAW:"raw",FILE:"file",URL_ENCODE:"url",FORM_DATA:"formdata"});var N=class{constructor(t=null,e=null,n=null){this.uri=t,this.method=e!==null?e:R.GET,this.requestHeader={},this.result={},this.type=n!==null?n:L.JSON,this.data={},this.requestHeader["Content-Type"]=this.setContentTypeBasedOnType(this.type),this.type===L.FORM_DATA&&delete this.requestHeader["Content-Type"],this.result[0]=function(i){v.getInstance().info('Unhandled response from "'+i.responseURL+'" with response data "'+i.response+'"')},this.xhr=new XMLHttpRequest}setContentTypeBasedOnType(t){switch(t){case L.JSON:return"application/json";case L.URL_ENCODE:return"application/x-www-form-urlencoded";case L.FILE:return"";case L.FORM_DATA:return"multipart/form-data";default:return"*/*"}}setMethod(t){this.method=t}getMethod(){return this.method}setResponseType(t){this.xhr.responseType=t}getResponseType(){return this.responseType}setRequestHeader(t,e){this.requestHeader[t]=e,e==="multipart/form-data"&&delete this.requestHeader[t]}getRequestHeader(){return this.requestHeader}setUri(t){this.uri=t}getUri(){return this.uri}setSuccess(t){this.result[200]=t}setResultCallback(t,e){this.result[t]=e}setData(t){this.data=t}addData(t,e){this.data[t]=e}getData(){return this.data}setType(t){this.type=t,this.requestHeader["Content-Type"]=this.setContentTypeBasedOnType(this.type)}getType(){return this.type}queryfy(t){let e=[];for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}send(){if(this.uri==="")return;let t=this;if(this.xhr.readyState!==1){let e=this.uri;if(this.method===R.GET)for(let n of Object.entries(this.data))e+="&"+n[0]+"="+n[1];else e=this.uri;this.xhr.open(this.method,S.build(e));for(let n in this.requestHeader)Object.prototype.hasOwnProperty.call(this.requestHeader,n)&&this.requestHeader[n]!==""&&this.requestHeader[n]!=="multipart/form-data"&&this.xhr.setRequestHeader(n,this.requestHeader[n])}window.omsApp.logger.log(S.build(this.uri)),window.omsApp.logger.log(this.xhr),this.xhr.onreadystatechange=function(){switch(t.xhr.readyState){case 4:typeof t.result[t.xhr.status]>"u"?t.result[0](t.xhr):t.result[t.xhr.status](t.xhr);break;default:}},this.type===L.JSON?this.xhr.send(JSON.stringify(this.data)):this.type===L.RAW||this.type===L.FILE?this.xhr.send(this.data):this.type===L.URL_ENCODE?this.xhr.send(this.queryfy(this.data)):this.type===L.FORM_DATA&&this.xhr.send(this.data)}};var M=Object.freeze({OPERA:"opera",FIREFOX:"firefox",SAFARI:"safari",IE:"msie",EDGE:"edge",CHROME:"chrome",BLINK:"blink",UNKNOWN:"unknown"});var B=Object.freeze({WINDOWS_10:"windows nt 10.0",WINDOWS_81:"windows nt 6.3",WINDOWS_8:"windows nt 6.2",WINDOWS_7:"windows nt 6.1",WINDOWS_VISTA:"windows nt 6.0",WINDOWS_SERVER:"windows nt 5.2",WINDOWS_XP:"windows nt 5.1",WINDOWS_XP_2:"windows xp",WINDOWS_2000:"windows nt 5.0",WINDOWS_ME:"windows me",WINDOWS_98:"win98",WINDOWS_95:"win95",WINDOWS_311:"win16",MAC_OS_X:"macintosh",MAC_OS_X_2:"mac os x",MAC_OS_9:"mac_powerpc",LINUX:"linux",UBUNTU:"ubuntu",IPHONE:"iphone",IPOD:"ipod",IPAD:"ipad",ANDROID:"android",BLACKBERRY:"blackberry",MOBILE:"webos",UNKNOWN:"UNKNOWN"});var V=class{static getBrowser(){return typeof window>"u"?M.UNKNOWN:window.opr&&opr.addons||window.opera||navigator.userAgent.indexOf(" OPR/")>=0?M.OPERA:typeof InstallTrigger<"u"?M.FIREFOX:Object.toString.call(window.HTMLElement).indexOf("Constructor")>0?M.SAFARI:document.documentMode?M.IE:window.StyleMedia?M.EDGE:window.chrome&&window.chrome.webstore?M.CHROME:(typeof isChrome<"u"&&isChrome||typeof isOpera<"u"&&isOpera)&&window.CSS?M.BLINK:M.UNKNOWN}static getOS(){if(typeof navigator>"u")return B.UNKNOWN;for(let t in B)if(Object.prototype.hasOwnProperty.call(B,t)&&navigator.userAgent.toLowerCase().indexOf(B[t])!==-1)return B[t];return B.UNKNOWN}};var v=class a{constructor(t=!0,e=!0,n=!1){this.verbose=t,this.ui=e,this.remote=n}static getInstance(t=!0,e=!0,n=!1){return a.instance||(a.instance=new a(t,e,n)),a.instance}interpolate(t,e){t=typeof t>"u"?a.MSG_FULL:t;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&typeof t=="string"&&(t=t.replace("{"+n+"}",e[n]));return typeof t!="string"?JSON.stringify(t):t}createContext(t,e,n){let i;try{throw new Error("")}catch(r){i=r.stack||""}return e.backtrace=i,e.datetime=new Date().toISOString(),e.version="1.0.0",e.os=V.getOS(),e.browser=V.getBrowser(),e.path=typeof window>"u"?"":window.location.href,e.datetime=new Date().toString(),e.level=n,e.message=t,e}write(t,e,n){e=this.createContext(t,e,n),this.verbose&&this.writeVerbose(t,e,n),this.ui&&this.writeUi(t,e),this.remote&&this.writeRemote(e)}writeUi(t,e){Notification.permission!=="granted"&&Notification.permission!=="denied"&&Notification.requestPermission().then(function(i){});let n=new Notification("Logger",{body:this.interpolate(t,e)});setTimeout(n.close.bind(n),4e3)}writeVerbose(t,e,n){let i="000";switch(n){case"info":case"notice":case"log":i="000";break;case"debug":i="289E39";break;case"warning":case"alert":i="FFA600";break;case"error":case"critical":case"emergency":i="CF304A";break;default:}console.log("%c"+this.interpolate(t,e,n),"color: #"+i)}writeRemote(t){let e=new N;e.setData(t),e.setType(jsOMS.Message.Response.Response.ResponseType.JSON),e.setUri("/{/lang}/api/log"),e.setMethod(N.RequestMethod.POST),e.setRequestHeader("Content-Type","application/json"),e.setSuccess(function(n){}),e.send()}emergency(t,e={}){this.write(t,e,q.EMERGENCY)}alert(t,e={}){this.write(t,e,q.ALERT)}critical(t,e={}){this.write(t,e,q.CRITICAL)}error(t,e={}){this.write(t,e,q.ERROR)}warning(t,e={}){this.write(t,e,q.WARNING)}notice(t,e={}){this.write(t,e,q.NOTICE)}info(t,e={}){this.write(t,e,q.INFO)}debug(t,e={}){this.write(t,e,q.DEBUG)}log(t,e,n={}){this.write(e,n,t)}console(t,e={}){this.writeVerbose(t,e,q.INFO)}};v.instance=null;v.MSG_FULL="{datetime}; {level}; {version}; {os}; {browser}; {path}; {message}";var z=class{};var Q=class{};var X=class{constructor(){this.logger=v.getInstance(),this.groups={},this.callbacks={}}addGroup(t,e){typeof this.groups[t]>"u"&&(this.groups[t]={}),this.groups[t][e]=!1}reset(t){for(let e in this.groups[t])Object.prototype.hasOwnProperty.call(this.groups[t],e)&&(this.groups[t][e]=!1)}hasOutstanding(t){if(typeof this.groups[t]>"u")return!1;for(let e in this.groups[t])if(!Object.prototype.hasOwnProperty.call(this.groups[t],e)||!this.groups[t][e])return!0;return!1}triggerSimilar(t,e="",n=null){let i=t.startsWith("/"),r=e.startsWith("/"),s={};for(let l in this.groups){let c=l.startsWith("/");i?l.match(t)&&(s[l]=[]):c&&t.match(l)?s[l]=[]:l===t&&(s[l]=[])}for(let l in s){for(let c in this.groups[l]){let d=c.startsWith("/");r?c.match(e)&&s[l].push(c):d&&e.match(c)?s[l].push(e):c===e&&s[l].push([])}s[l].length===0&&s[l].push(e)}let o=!1;for(let l in s)for(let c in s[l])o=this.trigger(l,c,n)||o;return o}trigger(t,e="",n=null){if(typeof this.callbacks[t]>"u"||Math.abs(Date.now()-this.callbacks[t].lastRun)<300||(typeof this.groups[t]<"u"&&(this.groups[t][e]=!0),this.hasOutstanding(t)))return!1;let i=this.callbacks[t].callbacks.length;this.callbacks[t].lastRun=Date.now();for(let r=0;r<i;++r)this.callbacks[t].callbacks[r](n);return this.callbacks[t].remove?this.detach(t):this.callbacks[t].reset&&this.reset(t),!0}detach(t){return this.detachCallback(t)|this.detachGroup(t)}detachCallback(t){return Object.prototype.hasOwnProperty.call(this.callbacks,t)?(delete this.callbacks[t],!0):!1}detachGroup(t){return Object.prototype.hasOwnProperty.call(this.groups,t)?(delete this.groups[t],!0):!1}attach(t,e,n=!1,i=!1){return Object.prototype.hasOwnProperty.call(this.callbacks,t)||(this.callbacks[t]={remove:n,reset:i,callbacks:[],lastRun:0}),this.callbacks[t].callbacks.push(e),!0}isAttached(t){return Object.prototype.hasOwnProperty.call(this.callbacks,t)}count(){return Object.keys(this.callbacks).length}};var $=class{constructor(){this.messages={}}add(t,e,n=null){n=typeof n<"u"?n:"any",typeof this.messages[t]>"u"&&(this.messages[t]=[]),this.messages[t][n]=e}run(t,e,n=null){n!==null&&typeof this.messages[t]<"u"&&typeof this.messages[t][n]<"u"?this.messages[t][n](e):typeof this.messages[t]<"u"?this.messages[t].null(e):v.instance.warning("Undefined type: "+t)}};var Y=class{constructor(){this.accounts=[]}add(t){this.accounts[t.getId()]=t}remove(t){return typeof this.accounts[t]<"u"?(delete this.accounts[t],!0):!1}get(t){return this.accounts[t]?this.accounts[t]:null}};var I=Object.freeze({OK:"ok",INFO:"info",WARNING:"warning",ERROR:"error",HIDDEN:"hidden"});var x=class{constructor(t,e,n,i=!1,r=!1){this.status=t,this.title=e,this.message=n,this.vibrate=i,this.isSticky=r,this.primaryButton=null,this.secondaryButton=null,this.duration=3e3}};var T=Object.freeze({APP_NOTIFICATION:1,BROWSER_NOTIFICATION:2});var U=class{constructor(t={}){this.responses=t}get(t=null){return t===null?this.responses:typeof this.responses[t]>"u"?null:this.responses[t]}count(){return this.responses.length}};var W=class a{constructor(t,e,n){this.id=t.id,this.inputComponent=t,this.inputField=this.inputComponent.getElementsByClassName("input")[0],this.dropdownElement=document.getElementById(this.id+"-popup"),this.tagElement=document.getElementById(this.id+"-tags"),this.dataList=this.dropdownElement.getElementsByTagName("table")[0],this.dataListBody=this.dataList.getElementsByTagName("tbody")[0],this.dataTpl=document.getElementById(this.id+"-rowElement"),this.tagTpl=this.tagElement!==null?this.tagElement.getElementsByTagName("template")[0]:null,this.src=this.inputField.getAttribute("data-src");let i=this;this.inputField.addEventListener("focusout",function(r){(r.relatedTarget===null||r.relatedTarget.parentElement===null||r.relatedTarget.parentElement.parentElement===null||!u.hasClass(r.relatedTarget.parentElement.parentElement.parentElement,"popup"))&&u.removeClass(i.dropdownElement,"active")}),this.inputField.addEventListener("keydown",function(r){(r.keyCode===13||r.keyCode===40)&&u.preventAll(r),r.keyCode===40?(i.selectOption(i.dataListBody.firstElementChild),u.preventAll(r)):i.inputTimeDelay({id:i.id,delay:300},i.changeCallback,i,r)}),this.inputField.addEventListener("focusin",function(r){u.addClass(i.dropdownElement,"active")}),this.dropdownElement.addEventListener("keydown",function(r){u.preventAll(r),r.code==="Escape"||r.code==="Delete"||r.code==="Backspace"?(i.inputField.focus(),i.clearDataListSelection(i)):r.code==="ArrowUp"?document.activeElement.previousElementSibling!==null&&(i.clearDataListSelection(i),i.selectOption(document.activeElement.previousElementSibling)):r.code==="ArrowDown"?document.activeElement.nextElementSibling!==null&&(i.clearDataListSelection(i),i.selectOption(document.activeElement.nextElementSibling)):(r.code==="Enter"||r.code==="Tab")&&(i.clearDataListSelection(i),i.addToResultList(i,document.activeElement))}),this.dropdownElement.addEventListener("focusout",function(r){i.clearDataListSelection(i),u.removeClass(i.dropdownElement,"active")}),this.dropdownElement.addEventListener("click",function(r){document.activeElement.tagName.toLowerCase()==="tr"&&(i.clearDataListSelection(i),i.addToResultList(i,document.activeElement),u.removeClass(i.dropdownElement,"active"))}),n.observe(this.tagElement,{childList:!0,attributes:!1,subtree:!1}),e.attach(this.id+"-tags-childList",function(r){let s=r.target.querySelectorAll(".close"),o=s===null?0:s.length;o<1||s[o-1].addEventListener("click",function(l){l.target.parentNode.parentNode!==null&&l.target.parentNode.parentNode.removeChild(l.target.parentNode)})})}remoteCallback(t,e){window.omsApp.logger.log(e),e=JSON.parse(e.response)[0];let n=e.length;if(t.dropdownElement.getAttribute("data-active")==="true"){for(;t.dataListBody.firstChild;)t.dataListBody.removeChild(t.dataListBody.firstChild);for(let i=0;i<n;++i){let r=t.dataTpl.content.cloneNode(!0),s=r.querySelectorAll("[data-tpl-text]"),o=s.length;for(let l=0;l<o;++l)s[l].appendChild(document.createTextNode(u.getArray(s[l].getAttribute("data-tpl-text"),e[i])));s=r.querySelectorAll("[data-tpl-value]"),o=s.length;for(let l=0;l<o;++l)s[l].setAttribute("data-value",u.getArray(s[l].getAttribute("data-tpl-value"),e[i]));r.firstElementChild.setAttribute("data-data",JSON.stringify(e[i])),t.dataListBody.appendChild(r),t.dataListBody.lastElementChild.addEventListener("focusout",function(l){if(l.relatedTarget===null)return;let c=l.relatedTarget.parentNode.firstElementChild;do if(c===l.relatedTarget){u.preventAll(l);return}while((c=c.nextElementSibling)!==null)})}}}changeCallback(t){if(typeof t.src<"u"&&t.src!==""){let e=new N(t.src);e.setSuccess(function(n){t.remoteCallback(t,n)}),e.send()}}selectOption(t){t.focus(),t.setAttribute("style","background: #f00"),u.addClass(t,"active")}clearDataListSelection(t){let e=t.dataListBody.getElementsByTagName("tr"),n=e.length;for(let i=0;i<n;++i)e[i].setAttribute("style",""),u.removeClass(e[i],"active")}addToResultList(t,e){let n=JSON.parse(e.getAttribute("data-data"));if(t.inputField.getAttribute("data-autocomplete")==="true"&&(t.inputField.value=u.getArray(t.inputField.getAttribute("data-value"),n)),t.tagElement!==null&&t.tagElement.getAttribute("data-active")==="true"){let i=t.tagTpl.content.cloneNode(!0),r=i.querySelectorAll("[data-tpl-value]"),s=r.length,o="",l="";for(let f=0;f<s;++f)r[f].setAttribute("data-value",u.getArray(r[f].getAttribute("data-tpl-value"),n)),l=u.getArray(r[f].getAttribute("data-tpl-value"),n),o+=l;if(t.tagElement.querySelectorAll('[data-tpl-uuid="'+o+'"').length!==0)return;i.firstElementChild.setAttribute("data-tpl-uuid",o),r=i.querySelectorAll("[data-tpl-text]"),s=r.length;for(let f=0;f<s;++f)r[f].appendChild(document.createTextNode(u.getArray(r[f].getAttribute("data-tpl-text"),n)));let c=/{\/.*?}/g,d=i.firstElementChild.outerHTML.match(c),p=d===null?0:d.length;for(let f=0;f<p;++f)i.firstElementChild.outerHTML=i.firstElementChild.outerHTML.replace(d[f],u.getArray(d[f].substring(1,d[f].length-1),n));t.tagElement.childElementCount>=t.tagElement.getAttribute("data-limit")&&t.tagElement.getAttribute("data-limit")!=="0"&&t.tagElement.removeChild(t.tagElement.firstElementChild),t.tagElement.appendChild(i)}t.inputField.getAttribute("data-emptyAfter")==="true"&&(t.inputField.value=""),t.inputField.focus()}inputTimeDelay(t,e,n,i){a.timerDelay[t.id]&&(clearTimeout(a.timerDelay[t.id]),delete a.timerDelay[t.id]),a.timerDelay[t.id]=setTimeout(function(){delete a.timerDelay[t.id],e(n,i)},t.delay)}};W.timerDelay={};var G=class a{constructor(t){this.id=t.id,this.inputComponent=t,this.inputField=this.inputComponent.getElementsByClassName("input-div")[0],this.dataContainer=this.inputField.getAttribute("data-container")===""?this.inputComponent:this.inputField.closest(this.inputField.getAttribute("data-container")),this.dataList=this.inputComponent.getElementsByClassName("input-datalist")[0],this.dataListBody=this.inputComponent.getElementsByClassName("input-datalist-body")[0],this.dataTpl=document.getElementsByClassName("input-data-tpl")[0],this.src=this.inputComponent.getAttribute("data-src");let e=this;this.inputField.addEventListener("focus",function(n){e.dataList.classList.remove("vh")}),this.inputField.addEventListener("click",function(n){e.dataList.classList.remove("vh")}),this.inputField.addEventListener("focusout",function(n){setTimeout(function(){e.dataList.classList.add("vh"),e.clearDataListSelection(e),e.inputField.textContent===""&&e.inputField.setAttribute("data-value",""),e.inputField.classList.contains("required")&&e.inputField.getAttribute("data-value")===""?e.inputField.classList.add("invalid"):e.inputField.classList.remove("invalid");let i=e.dataListBody.getElementsByTagName("div"),r=i.length;if(r>0&&e.inputField.getAttribute("data-value")!==""){let s=!1;for(let o=0;o<r;++o)if(i[o].textContent===e.inputField.textContent){s=!0;break}s?e.inputField.classList.remove("invalid"):e.inputField.classList.add("invalid")}},100)}),this.inputField.addEventListener("keydown",function(n){e.dataList.classList.contains("vh")&&e.dataList.classList.remove("vh"),(n.keyCode===13||n.keyCode===40)&&u.preventAll(n),n.keyCode===40?(e.selectOption(e.dataListBody.firstElementChild),e.dataList.focus(),u.preventAll(n)):e.inputTimeDelay({id:e.id,delay:300},e.changeCallback,e,n)}),this.dataList.addEventListener("keydown",function(n){u.preventAll(n),n.code==="Escape"||n.code==="Delete"||n.code==="Backspace"?(e.inputField.focus(),e.clearDataListSelection(e)):n.code==="ArrowUp"?document.activeElement.previousElementSibling!==null&&(e.clearDataListSelection(e),e.selectOption(document.activeElement.previousElementSibling)):n.code==="ArrowDown"?document.activeElement.nextElementSibling!==null&&(e.clearDataListSelection(e),e.selectOption(document.activeElement.nextElementSibling)):(n.code==="Enter"||n.code==="Tab")&&(e.clearDataListSelection(e),e.addToResultList(e,document.activeElement))}),this.dataList.addEventListener("click",function(n){e.clearDataListSelection(e),e.addToResultList(e,n.target),e.dataList.classList.add("vh")})}remoteCallback(t,e){window.omsApp.logger.log(e),e=JSON.parse(e.response)[0];let n=e.length;if(t.dataList.getAttribute("data-active")!=="true")return;for(t.inputField.textContent===""&&t.inputField.setAttribute("data-value","");t.dataListBody.firstChild;)t.dataListBody.removeChild(t.dataListBody.firstChild);let i=!1;for(let r=0;r<n;++r){let s=t.dataTpl.content.cloneNode(!0),o=s.querySelectorAll("[data-tpl-text]"),l=o.length;for(let c=0;c<l;++c)o[c].appendChild(document.createTextNode(u.getArray(o[c].getAttribute("data-tpl-text"),e[r])));o=s.querySelectorAll("[data-tpl-value]"),l=o.length;for(let c=0;c<l;++c)o[c].setAttribute("data-value",u.getArray(o[c].getAttribute("data-tpl-value"),e[r]));s.firstElementChild.setAttribute("data-data",JSON.stringify(e[r])),!i&&t.inputField.textContent===s.firstElementChild.textContent&&(s.firstElementChild.classList.add("active"),t.inputField.setAttribute("data-value",s.firstElementChild.getAttribute("data-value")),i=!0),t.dataListBody.appendChild(s)}!i&&t.inputField.getAttribute("data-value")!==""?t.inputField.classList.add("invalid"):t.inputField.classList.remove("invalid")}changeCallback(t){if(typeof t.src<"u"&&t.src!==""){let e=new N(t.src);e.addData(t.inputField.getAttribute("data-name"),t.inputField.textContent),e.addData("limit",t.inputField.getAttribute("data-limit")),e.setSuccess(function(n){t.remoteCallback(t,n)}),e.send()}}selectOption(t){t.focus(),u.addClass(t,"active")}clearDataListSelection(t){let e=t.dataListBody.getElementsByTagName("div"),n=e.length;for(let i=0;i<n;++i)u.removeClass(e[i],"active")}addToResultList(t,e){let n=JSON.parse(e.getAttribute("data-data"));t.inputField.getAttribute("data-autocomplete")==="true"&&(t.inputField.value=u.getArray(t.inputField.getAttribute("data-value"),n)),t.inputField.setAttribute("data-value",e.getAttribute("data-value")),t.inputField.textContent=e.textContent,t.inputField.focus(),t.dataList.classList.add("vh")}inputTimeDelay(t,e,n,i){a.timerDelay[t.id]&&(clearTimeout(a.timerDelay[t.id]),delete a.timerDelay[t.id]),a.timerDelay[t.id]=setTimeout(function(){delete a.timerDelay[t.id],e(n,i)},t.delay)}};G.timerDelay={};var O=class{constructor(t){this.visObs=null,this.app=t}bind(t=null){let e=null;t!==null&&(e=document.getElementById(t)),this.bindHref(e),this.bindIframe(e),this.bindLazyLoad(e),this.bindInput(e)}bindHref(t=null){t=t!==null?t.querySelectorAll("[data-href], [href]"):document.querySelectorAll("[data-href], [href]");let e=t.length;for(let n=0;n<e;++n)t[n].getAttribute("data-action")===null&&t[n].addEventListener("click",function(i){if(i.target.parentElement!==this&&i.target.parentElement.getElementsByTagName("input").length>0||i.target.getElementsByTagName("input").length>0){let s=i.target.querySelector("input");if(s!==null){s.click();return}}u.preventAll(i);let r=this.getAttribute("data-href");r=r===null?this.getAttribute("href"):r,this.getAttribute("target")==="_blank"||this.getAttribute("data-target")==="_blank"||i.button===1?window.open(S.build(r),"_blank"):this.getAttribute("data-redirect")!==null?window.location.href=S.build(r):r!==null&&(window.location=S.build(r))})}bindIframe(t=null){t=t!==null?t:document.getElementsByTagName("iframe");let e=t.length;for(let n=0;n<e;++n)t[n].getAttribute("data-src")!==null&&(t[n].src=S.build(t[n].getAttribute("data-src"))),t[n].addEventListener("load",function(){let i=this.parentElement.getElementsByClassName("spinner");i.length>0&&(i[0].style.display="none")})}bindLazyLoad(t=null){t=t!==null?t.querySelectorAll("[data-lazyload]"):document.querySelectorAll("[data-lazyload]");let e=t.length;!this.visObs&&window.IntersectionObserver&&(this.visObs=new IntersectionObserver(function(n,i){n.forEach(r=>{r.intersectionRatio>0&&(i.unobserve(r.target),r.target.src=r.target.dataset.lazyload,delete r.target.dataset.lazyload)})}));for(let n=0;n<e;++n)this.visObs?this.visObs.observe(t[n]):(t[n].src=t[n].dataset.lazyload,delete t[n].dataset.lazyload)}bindInput(t=null){let e=t!==null?[t]:document.getElementsByClassName("advIpt"),n=e.length;for(let i=0;i<n;++i)new W(e[i],this.app.eventManager,this.app.uiManager.getDOMObserver());e=t!==null?[t]:document.querySelectorAll(".smart-input-wrapper"),n=e.length;for(let i=0;i<n;++i)e[i].querySelector(".input-div").hasAttribute("contenteditable")&&new G(e[i])}static setValueOfElement(t,e){if(t.hasAttribute("data-value")){t.setAttribute("data-value",e);return}let n=t.tagName.toLowerCase();if(n==="input")t.type==="radio"?(t.checked=!1,t.value===e&&(t.checked=!0)):t.type==="checkbox"?(t.checked=!1,e.split(",").includes(t.value)&&(t.checked=!0)):t.value=e;else if(n==="select"){let i=t.options.length;for(let r=0;r<i;++r)if(t.options[r].value===e){t.options[r].selected=!0;break}}else t.getAttribute("value")!==null?t.value=u.htmlspecialchars_decode(e):t.innerHTML=e}static setTextOfElement(t,e){let n=t.tagName.toLowerCase();if(n==="h1")t.innerHTML=u.htmlspecialchars_encode(e);else if(t.getAttribute("value")!==null)t.value===""&&(t.value=u.htmlspecialchars_decode(e));else if(n==="select"){let i=t.options.length;for(let r=0;r<i;++r)if(t.options[r].text===e){t.options[r].selected=!0;break}}else t.innerHTML=e}static getValueFromDataSource(t){if(t.getAttribute("data-value")!==null)return t.getAttribute("data-value");let e=t.tagName.toLowerCase();if(e==="input"||t.getAttribute("value")!==null){if(t.getAttribute("type")==="radio"){let n=document.querySelector('input[type=radio][name="'+t.name+'"]:checked');if(n===null)return"";t=n}else if(t.getAttribute("type")==="checkbox"&&!t.checked)return"";return t.value}else return e==="select"?t.options[t.selectedIndex].value:t.innerText.trim(" ")}static getTextFromDataSource(t){let e=t.tagName.toLowerCase();if(e==="input"){if(t.getAttribute("type")==="radio"){let n=document.querySelector('input[type=radio][name="'+t.name+'"]:checked');return n===null?"":document.querySelector('label[for="'+n.id+'"]').innerText.trim(" ")}else if(t.getAttribute("type")==="checkbox")return t.checked?document.querySelector('label[for="'+t.id+'"]').innerText.trim(" "):"";return t.value}else return e==="select"?t.options[t.selectedIndex].text:t.getAttribute("value")!==null?t.value:t.innerHTML.trim(" ")}};var Z=class a{constructor(t){this.app=t,this.forms={},this.ignore={}}get(t){return Object.prototype.hasOwnProperty.call(this.forms,t)||this.bind(t),this.forms[t]}hasChanges(){let t=this.forms.length;for(let e=0;e<t;++e)if(this.forms[e].hasChange())return!0;return!1}isIgnored(t){return this.ignore.indexOf(t)!==-1}bind(t=null){if(t!==null&&typeof this.ignore[t]>"u"){this.bindForm(t);return}let e=document.querySelectorAll("form, [data-tag=form]"),n=e?e.length:0;for(let i=0;i<n;++i){let r=e[i].getAttribute("id");typeof r<"u"&&r!==null&&typeof this.ignore[r]>"u"?this.bindForm(r):v.instance.info("A form doesn't have an ID.")}}bindForm(t=null){if(t===null){v.instance.info("A form doesn't have an ID.");return}this.forms[t]=new F(t);let e=this,n=0,i=this.forms[t].getElementsToBind(),r=i.length;for(let o=0;o<r;++o)i[o].addEventListener("click",function(l){e.formActions(e,l,t)}),this.forms[t].isOnChange()||i[o].addEventListener("change",function(){window.omsApp.state&&(window.omsApp.state.hasChanges=!0)});let s=this.forms[t].getImagePreviews();n=s===null?0:s.length;for(let o=0;o<n;++o)this.bindImagePreview(s[o],t);if(this.forms[t].isOnChange()){let o=this.forms[t].getFormElement().getAttribute("data-ui-container");(o!==null?this.forms[t].getFormElement().querySelector(o):this.forms[t].getFormElement()).addEventListener("change",function(c){u.preventAll(c),window.omsApp.state&&(window.omsApp.state.hasChanges=!0);let d=c.target.tagName.toLowerCase();if(d==="input"||d==="textarea"){let p=null;e.forms[t].getFormElement().tagName.toLowerCase()==="table"&&(p=c.srcElement.closest(e.forms[t].getFormElement().getAttribute("data-ui-element"))),e.submit(e.forms[t],null,p,"post")}})}}formActionRemove(t,e,n,i){u.preventAll(e);let r=t.forms[n].getRemove()[i],s=function(l=null){if(l!==null&&l.status!==200){t.app.notifyManager.send(new x(I.ERROR,"Failure","Some failure happened"),T.APP_NOTIFICATION);return}let c=r.closest(document.getElementById(n).getAttribute("data-ui-element"));window.omsApp.logger.log(document.getElementById(n).getAttribute("data-ui-element")),c.parentNode.removeChild(c)},o=document.getElementById(n).getAttribute("action")!==null||document.getElementById(n).getAttribute("data-action")!==null?t.forms[n].getFormElement():document.getElementById(n).getAttribute("data-update-form")!==null?t.forms[document.getElementById(n).getAttribute("data-update-form")].getFormElement():document.getElementById(n).getAttribute("data-delete-form")!==null?t.forms[document.getElementById(n).getAttribute("data-delete-form")].getFormElement():null;if(o!==null){let l=new N(o.hasAttribute("data-action-delete")?o.getAttribute("data-action-delete"):o.tagName.toLowerCase()!=="form"?o.getAttribute("data-action"):o.getAttribute("action"),R.DELETE);l.setResultCallback(0,s),l.send()}else s()}formActionAdd(t,e,n,i){u.preventAll(e),t.forms[n].isValid()&&(document.getElementById(n).getAttribute("data-add-form")===null?this.formActionAddInline(t,e,n,i):this.formActionAddExternal(t,e,n,i))}formActionAddInline(t,e,n,i){let r=t.forms[n].getFormElement(),s=r.getAttribute("data-ui-container"),o=s.charAt(0)==="#"?document.querySelector(s):r.querySelector(s);if(r.getAttribute("data-update-tpl")){let l=o.querySelector(r.getAttribute("data-update-tpl")).content.cloneNode(!0);o.appendChild(l.firstElementChild)}else{let l=o.querySelector(r.getAttribute("data-add-tpl")).content.cloneNode(!0);o.appendChild(l.firstElementChild)}}formActionAddExternal(t,e,n,i){let r=t.forms[n].getFormElement(),s=r.getAttribute("data-ui-container"),o=s.charAt(0)==="#"?document.querySelector(s):r.querySelector(s),l=r.getAttribute("data-add-tpl").split(","),c=l.length,d=[],p=[],f=[];for(let m=0;m<c;++m){f.push(document.querySelector(l[m]).content.cloneNode(!0));let A=f[m].querySelector("[data-tpl-value]").getAttribute("data-tpl-value"),g=A.startsWith("http")||A.startsWith("{")?f[m].firstElementChild:r;d=d.concat(g.hasAttribute("data-tpl-value")?g:Array.prototype.slice.call(g.querySelectorAll("[data-tpl-value]"))),p=p.concat(g.hasAttribute("data-tpl-text")?g:Array.prototype.slice.call(g.querySelectorAll("[data-tpl-text]"))),a.setRandomIdForElement(f[m].firstElementChild)}let h={};t.forms[n].setSuccess(function(m,A){if(A.status===200){a.setDataInElement("value",f,d,h),a.setDataInElement("text",f,p,h);for(let g=0;g<c;++g)o.appendChild(f[g].firstElementChild);window.omsApp.logger.log(h),S.setQuery("$id",m.get("response").id),a.setDataFromRemoteUrls(h),t.forms[n].resetValues()}}),t.submit(t.forms[n],t.forms[n].getAdd()[i])}formActionSave(t,e,n,i){u.preventAll(e),document.querySelector('[data-update-form="'+n+'"')===null?this.formActionSaveInline(t,e,n,i):this.formActionSaveExternal(t,e,n,i)}formActionSaveInline(t,e,n,i){if(!t.forms[n].isValid())return;let r=t.forms[n].getFormElement(),s=r.getAttribute("data-ui-container"),o=s.charAt(0)==="#"?document.querySelector(s):r.querySelector(s),l=r.getAttribute("data-ui-element").split(","),c=l.length,d=[],p=e.target.closest(r.getAttribute("data-ui-element")),f=[],h=[];if(p.getAttribute("data-id")===null||p.getAttribute("data-id")===""){let m=r.getAttribute("data-add-tpl").split(","),A=m.length,g=[];for(let y=0;y<A;++y){g.push(document.querySelector(m[y]).content.cloneNode(!0));let b=g[y].querySelector("[data-tpl-value]").getAttribute("data-tpl-value"),E=b.startsWith("http")||b.startsWith("{")?g[y].firstElementChild:p;f=f.concat(E.hasAttribute("data-tpl-value")?E:Array.prototype.slice.call(E.querySelectorAll("[data-tpl-value]"))),h=h.concat(E.hasAttribute("data-tpl-text")?E:Array.prototype.slice.call(E.querySelectorAll("[data-tpl-text]"))),a.setRandomIdForElement(g[y].firstElementChild)}let w={};t.forms[n].setSuccess(function(y,b){if(b.status===200){a.setDataInElement("value",g,f,w),a.setDataInElement("text",g,h,w);for(let E=0;E<A;++E)o.appendChild(g[E].firstElementChild);p.parentNode.removeChild(p),window.omsApp.logger.log(w),S.setQuery("$id",y.get("response").id),a.setDataFromRemoteUrls(w)}})}else{for(let g=0;g<c;++g){l[g]=l[g].trim(),d.push(r.querySelector(l[g]+'[data-id="'+p.getAttribute("data-id")+'"]'));let w=d[g].querySelector("[data-tpl-value]").getAttribute("data-tpl-value"),y=w.startsWith("http")||w.startsWith("{")?d[g].firstElementChild:p;f=f.concat(y.hasAttribute("data-tpl-value")?y:Array.prototype.slice.call(y.querySelectorAll("[data-tpl-value]"))),h=h.concat(y.hasAttribute("data-tpl-text")?y:Array.prototype.slice.call(y.querySelectorAll("[data-tpl-text]")))}let m=o.querySelector('.vh[data-id="'+p.getAttribute("data-id")+'"]'),A={};u.removeClass(m,"vh"),t.forms[n].setSuccess(function(g,w){w.status===200&&(a.setDataInElement("value",[m],f,A),a.setDataInElement("text",[m],h,A),p.parentNode.removeChild(p),a.setDataFromRemoteUrls(A))})}}formActionSaveExternal(t,e,n,i){let r=document.querySelector('[data-update-form="'+n+'"'),s=n;if(n=r.getAttribute("id"),!t.forms[n].isValid())return;let o=t.forms[n].getFormElement(),l=t.forms[s].getFormElement(),c=o.getAttribute("data-ui-element").split(","),d=c.length,p=[],f=[],h=[];for(let b=0;b<d;++b){c[b]=c[b].trim(),p.push(o.querySelector(c[b]+'[data-id="'+l.getAttribute("data-id")+'"]'));let E=p[b].querySelector("[data-tpl-value]").getAttribute("data-tpl-value"),C=E.startsWith("http")||E.startsWith("{")?p[b].firstElementChild:l;f=f.concat(C.hasAttribute("data-tpl-value")?C:Array.prototype.slice.call(C.querySelectorAll("[data-tpl-value]"))),h=h.concat(C.hasAttribute("data-tpl-text")?C:Array.prototype.slice.call(C.querySelectorAll("[data-tpl-text]")))}let m={};for(let b=0;b<d;++b)u.removeClass(p[b],"animated"),u.removeClass(p[b],"greenCircleFade"),window.requestAnimationFrame(E=>{window.requestAnimationFrame(C=>{u.addClass(p[b],"animated"),u.addClass(p[b],"medium-duration"),u.addClass(p[b],"greenCircleFade")})});t.forms[s].setSuccess(function(b,E){if(E.status!==200){t.forms[s].resetValues();return}a.setDataInElement("value",p,f,m),a.setDataInElement("text",p,h,m),a.setDataFromRemoteUrls(m);for(let C=0;C<d;++C)u.removeClass(p[C],"animated"),u.removeClass(p[C],"greenCircleFade"),u.removeClass(p[C],"medium-duration"),window.requestAnimationFrame(jt=>{window.requestAnimationFrame(Pt=>{u.addClass(p[C],"animated medium-duration greenCircleFade")})});t.forms[s].resetValues()}),l.setAttribute("data-id",""),t.submit(t.forms[s],t.forms[s].getSave()[i]);let A=t.forms[s].getAdd(),g=A.length;for(let b=0;b<g;++b)u.removeClass(A[b],"vh");let w=t.forms[s].getSave();g=w.length;for(let b=0;b<g;++b)u.addClass(w[b],"vh");let y=t.forms[s].getCancel();g=y.length;for(let b=0;b<g;++b)u.addClass(y[b],"vh")}formActionCancel(t,e,n,i){let r=document.getElementById(n);r.getAttribute("data-update-form")===null&&r.getAttribute("data-ui-container")!==null&&r.getAttribute("data-ui-element")!==null?this.formActionCancelInline(t,e,n,i):this.formActionCancelExternal(t,e,n,i)}formActionCancelInline(t,e,n,i){let r=t.forms[n].getFormElement(),s=r.getAttribute("data-ui-container"),o=s.charAt(0)==="#"?document.querySelector(s):r.querySelector(s),l=e.target.closest(r.getAttribute("data-ui-element")),c=o.querySelector('.vh[data-id="'+l.getAttribute("data-id")+'"]');u.removeClass(c,"vh"),l.parentNode.removeChild(l)}formActionCancelExternal(t,e,n,i){t.forms[n].resetValues(),t.forms[n].getFormElement().setAttribute("data-id","");let r=0,s=t.forms[n].getAdd();r=s.length;for(let c=0;c<r;++c)u.removeClass(s[c],"vh");let o=t.forms[n].getSave();r=o.length;for(let c=0;c<r;++c)u.addClass(o[c],"vh");let l=t.forms[n].getCancel();r=l.length;for(let c=0;c<r;++c)u.addClass(l[c],"vh")}formActionUpdate(t,e,n,i){u.preventAll(e),document.getElementById(n).getAttribute("data-update-form")===null?this.formActionUpdateInline(t,e,n,i):this.formActionUpdateExternal(t,e,n,i)}formActionUpdateInline(t,e,n,i){let r=t.forms[n].getFormElement(),s=r.getAttribute("data-ui-container"),o=e.target.closest(r.getAttribute("data-ui-element"));o===null&&(o=r.querySelector(r.getAttribute("data-ui-element"))),u.addClass(o,"vh");let l=o.querySelectorAll("[data-tpl-value]"),c=o.querySelectorAll("[data-tpl-text]"),d=s.charAt(0)==="#"?document.querySelector(s):r.querySelector(s),p=r.getAttribute("data-update-tpl").split(","),f=p.length,h=[];for(let y=0;y<f;++y)h.push(document.querySelector(p[y]).content.cloneNode(!0)),h[y].firstElementChild.setAttribute("data-id",o.getAttribute("data-id"));let m={};a.setDataInElement("value",h,l,m),a.setDataInElement("text",h,c,m);for(let y=0;y<f;++y)d.insertBefore(h[y].firstElementChild,o);let A=t.forms[n].getSave(),g=A.length;for(let y=0;y<g;++y)u.removeClass(A[y],"vh");let w=t.forms[n].getCancel();g=w.length;for(let y=0;y<g;++y)u.removeClass(w[y],"vh");t.forms[n].setSuccess(function(y){y.get("status")!=="undefined"&&y.get("status")!==I.HIDDEN&&t.app.notifyManager.send(new x(y.get("status"),y.get("title"),y.get("message")),T.APP_NOTIFICATION),window.omsApp.logger.log(m),S.setQuery("$id",y.get("response").id),a.setDataFromRemoteUrls(m)})}formActionUpdateExternal(t,e,n,i){let r=t.forms[n].getFormElement(),s=e.target.closest(r.getAttribute("data-ui-element")),o=r.getAttribute("data-update-form"),l=s.querySelectorAll("[data-tpl-value]"),c=s.querySelectorAll("[data-tpl-text]"),d=0;t.forms[o].resetValues(),t.forms[o].getFormElement().setAttribute("data-id",s.getAttribute("data-id"));let p=t.forms[o].getAdd();d=p.length;for(let g=0;g<d;++g)u.addClass(p[g],"vh");let f=t.forms[o].getSave();d=f.length;for(let g=0;g<d;++g)u.removeClass(f[g],"vh");let h=t.forms[o].getCancel();d=h.length;for(let g=0;g<d;++g)u.removeClass(h[g],"vh");let m={};a.insertDataIntoForm(t,"value",o,l,m),d=c.length;let A=l.length;for(let g=0;g<d;++g)if(c[g].tagName.toLowerCase()==="select"){for(let y=0;y<A;++y)if(l[y].getAttribute("name")===c[g].getAttribute("name")){c[g]=null;break}}a.insertDataIntoForm(t,"text",o,c,m),t.forms[o].setSuccess(function(g){g.get("status")!=="undefined"&&g.get("status")!==I.HIDDEN&&t.app.notifyManager.send(new x(g.get("status"),g.get("title"),g.get("message")),T.APP_NOTIFICATION),window.omsApp.logger.log(m),S.setQuery("$id",g.get("response").id),a.setDataFromRemoteUrls(m)})}formActions(t,e,n){let i=0;(i=Array.from(t.forms[n].getRemove()).indexOf(e.target))!==-1?this.formActionRemove(t,e,n,i):(i=Array.from(t.forms[n].getAdd()).indexOf(e.target))!==-1?this.formActionAdd(t,e,n,i):(i=Array.from(t.forms[n].getSave()).indexOf(e.target))!==-1?this.formActionSave(t,e,n,i):(i=Array.from(t.forms[n].getCancel()).indexOf(e.target))!==-1?(u.preventAll(e),this.formActionCancel(t,e,n,i)):(i=Array.from(t.forms[n].getUpdate()).indexOf(e.target))!==-1?this.formActionUpdate(t,e,n,i):((i=Array.from(t.forms[n].getSubmit()).indexOf(e.target))!==-1||(i=Array.from(t.forms[n].getSubmit()).indexOf(e.target.parentNode))!==-1)&&(u.preventAll(e),t.submit(t.forms[n],t.forms[n].getSubmit()[i]))}bindImagePreview(t,e){t.addEventListener("change",function(){let n=document.querySelector("#preview-"+t.getAttribute("name"));n.src=window.URL.createObjectURL(t.files[0]),n.onload=function(){window.URL.revokeObjectURL(this.src)}})}submit(t,e=null,n=null,i=null,r=null){let s=this,o=t.getSubmitInjects(),l=0;e!==null&&(r=e.getAttribute("formaction")),e!==null&&(i=e.getAttribute("formmethod")),this.app.eventManager.isAttached(t.getId())||this.app.eventManager.attach(t.getId(),function(){s.submitForm(t,r,i,n)},!0);for(let d in o)if(Object.prototype.hasOwnProperty.call(o,d)){if(++l,o[d](t,t.getId())===!1)return}else v.instance.warning("Invalid property.");l<1&&this.app.eventManager.trigger(t.getId());let c=t.getFirstInputElement();c!==null&&c.focus()}submitForm(t,e=null,n=null,i=null){let r=t.getData(i);if(!t.isValid(r)){this.app.notifyManager.send(new x(I.INFO,u.lang.Info,u.lang.invalid_form),T.APP_NOTIFICATION),v.instance.debug('Form "'+t.getId()+'" has invalid values.');return}if(t.getMethod()!==R.GET&&Math.abs(Date.now()-t.getLastSubmit())<500)return;t.updateLastSubmit();let s=new N,o=this,l=t.getFormElement().getAttribute("data-redirect");s.setData(r),s.setType(L.FORM_DATA),s.setUri(e!==null?e:t.getAction()),s.setMethod(n!==null?n:t.getMethod()),s.setResultCallback(0,function(c){window.omsApp.logger.log(c.response);let d=c.getResponseHeader("location");d!==null&&(window.location=d);let p=null,f=null;if(c.getResponseHeader("content-type").includes("application/octet-stream")){f=new Blob([c.response],{type:"application/octet-stream"});let h=document.createElement("a");h.style="display: none",document.body.appendChild(h);let m=window.URL.createObjectURL(f);h.href=m;let A=c.getResponseHeader("content-disposition"),g="";if(A&&A.indexOf("attachment")!==-1){let y=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(A);y!==null&&y[1]&&(g=y[1].replace(/['"]/g,""))}h.download=g,h.click(),window.URL.revokeObjectURL(m),document.body.removeChild(h)}else if(c.getResponseHeader("content-type").includes("text/html"))f=c.response,document.documentElement.innerHTML=c.response,window.omsApp.reInit();else try{f=JSON.parse(c.response);let h=new U(f[0]),m=null;p=parseInt(c.getResponseHeader("status")),(m=t.getSuccess())!==null&&(p===200||p===null)&&(m(h,c),t.setSuccess(null)),h.get("type")!==null?o.app.responseManager.run(h.get("type"),h.get(),null):typeof f[0].status<"u"&&f[0].status!==I.HIDDEN&&o.app.notifyManager.send(new x(f[0].status,f[0].title,f[0].message),T.APP_NOTIFICATION)}catch(h){v.instance.log(h),v.instance.error(`Invalid form response. 
URL: `+t.getAction()+`
Request: `+JSON.stringify(t.getData())+`
Response: `+c.response),o.app.notifyManager.send(new x(I.ERROR,"Failure","Some failure happened"),T.APP_NOTIFICATION),p=400}if(l!==null&&(p===200||p===null)){let h=S.build(l,f);fetch(h).then(m=>m.text()).then(m=>{document.documentElement.innerHTML=m,window.omsApp.state&&(window.omsApp.state.hasChanges=!1),history.pushState({},null,h),window.omsApp.reInit()}).catch(m=>{console.warn(m)})}}),window.omsApp.state&&(window.omsApp.state.hasChanges=!1),s.send(),t.getFinally()!==null&&t.getFinally()()}count(){return this.forms.length}static setDataFromRemoteUrls(t){for(let e in t){let n=new N(e);n.setResultCallback(200,function(i){let r=t[e].length;for(let s=0;s<r;++s){let o=t[e][s].path;t[e][s].type==="value"?O.setValueOfElement(t[e][s].element,o!==null?u.getArray(o,JSON.parse(i.response)):i.response):O.setTextOfElement(t[e][s].element,o!==null?u.getArray(o,JSON.parse(i.response)):i.response)}}),n.send()}}static setRandomIdForElement(t){if(t.getAttribute("data-id")!==null&&t.getAttribute("data-id")!=="")return;let e="";do e="r-"+Math.random().toString(36).substring(7);while(document.querySelector('[data-id="'+e+'"]')!==null);return t.setAttribute("data-id",e),e}static setDataInElement(t,e,n,i={}){let r=[],s=n.length,o=e.length;for(let l=0;l<s;++l){let c=n[l].hasAttribute("data-tpl-"+t+"-path")?n[l].getAttribute("data-tpl-"+t+"-path"):null;for(let d=0;d<o;++d){let p=e[d]instanceof DocumentFragment?e[d].firstElementChild:e[d],f=p.hasAttribute("data-tpl-"+t)&&p.getAttribute("data-tpl-"+t)===n[l].getAttribute("data-tpl-"+t)?[p]:p.querySelectorAll("[data-tpl-"+t+'="'+n[l].getAttribute("data-tpl-"+t)+'"'),h=f.length;for(let m=0;m<h;++m)r.includes(f[m])||c!==null&&c!==f[m].getAttribute("data-tpl-"+t+"-path")||(r.push(f[m]),n[l].getAttribute("data-tpl-"+t).startsWith("http")||n[l].getAttribute("data-tpl-"+t).startsWith("{")?a.populateRemoteUrls(f[m],t,n[l],c,i):t==="value"?O.setValueOfElement(f[m],O.getValueFromDataSource(n[l])):t==="text"&&O.setTextOfElement(f[m],O.getTextFromDataSource(n[l])))}}}static insertDataIntoForm(t,e,n,i,r={}){let s=i.length;for(let o=0;o<s;++o){if(i[o]===null)continue;let l=t.forms[n].getFormElement().querySelectorAll("[data-tpl-"+e+'="'+i[o].getAttribute("data-tpl-"+e)+'"'),c=i[o].hasAttribute("data-tpl-"+e+"-path")?i[o].getAttribute("data-tpl-"+e+"-path"):null,d=l.length;for(let p=0;p<d;++p)i[o].getAttribute("data-tpl-"+e).startsWith("http")||i[o].getAttribute("data-tpl-"+e).startsWith("{")?a.populateRemoteUrls(l[p],e,i[o],c,r):e==="value"?O.setValueOfElement(l[p],O.getValueFromDataSource(i[o])):e==="text"&&(i[o].getAttribute("data-tpl-text")!==i[o].getAttribute("data-tpl-value")||i[o].getAttribute("data-value")!==null)&&O.setTextOfElement(l[p],O.getTextFromDataSource(i[o]))}}static populateRemoteUrls(t,e,n,i,r){let s=n.getAttribute("data-tpl-"+e).startsWith("/")?document.getElementsByTagName("base")[0].href:"";r[s+n.getAttribute("data-tpl-"+e)]===void 0&&(r[s+n.getAttribute("data-tpl-"+e)]=[]),r[s+n.getAttribute("data-tpl-"+e)].push({path:i,element:t,type:e})}};var _=class{constructor(t){this.app=t}bind(t=null){if(t!==null){let i=document.getElementById(t);i&&this.bindElement(i);return}let e=document.getElementsByClassName("tabview"),n=e?e.length:0;for(let i=0;i<n;++i)this.bindElement(e[i])}bindElement(t){let e=t.querySelectorAll(".tab-links li"),n=e.length;for(let i=0;i<n;++i)e[i].addEventListener("click",function(r){let s=this.querySelector("label").getAttribute("for"),o=this.parentNode.getElementsByClassName("active");if(o.length>0){let c=s.split("&"),d=c.indexOf(o[0].getElementsByTagName("label")[0].getAttribute("for"));d>-1&&c.splice(d,1),s=c.join("&"),u.removeClass(o[0],"active")}s=s.split("&").join("&"),u.addClass(this,"active"),u.hasClass(this.closest(".tabview"),"url-rewrite")&&window.history.replaceState(null,"",S.build("{%}#"+(s===""?"":s)))});this.activateTabUri(t)}activateTabUri(t){let e=window.location.href.includes("#")?k.parseUrl(window.location.href).fragment:"";if(e===null||typeof e>"u")return;let n=e.split("&"),i=n.length;if(i>0&&e!=="")for(let r=0;r<i;++r){let s=t.querySelector('label[for="'+n[r]+'"]');typeof s<"u"&&s!==null&&s.click()}t.querySelector(".tab-links")?.querySelector(".active")===null&&t.querySelector(".tab-links").querySelector("label").click()}};var tt=class{constructor(t){this.id=t,this.table=null}bind(){this.table=document.getElementById(this.id)}serialize(){let t=document.getElementById(this.id),e={caption:null,header:[],rows:[]};e.caption=t.getElementsByTagName("caption")[0].innerText;let n=t.querySelectorAll("thead tr td, thead tr th"),i=n.length;for(let o=0;o<i;++o)e.header.push(n[o].innerText);let r=t.querySelectorAll("tbody tr"),s=r.length;for(let o=0;o<s;++o){e.rows[o]=[];let l=r[o].querySelectorAll("td, th"),c=l.length;for(let d=0;d<c;++d)e.rows[o].push(l[d].innerText)}return e}getExport(){return document.querySelectorAll("#"+this.id+" .download")[0]}getSorting(){return document.querySelectorAll("#"+this.id+" thead .sort-asc, #"+this.id+" thead .sort-desc")}getFilter(){return document.querySelectorAll("#"+this.id+" .filter")}getHeader(){return document.querySelector("#"+this.id+" thead")}getCheckboxes(){return document.querySelectorAll("#"+this.id+" thead input[type=checkbox]")}getSortableRows(){return document.querySelectorAll("#"+this.id+" tbody .order-up, #"+this.id+" tbody .order-down")}};var Nt=Object.freeze({TEXT:"text",JSON:"json",DOCUMENT:"document",BLOB:"blob",ARRAYBUFFER:"arraybuffer",DEFAULT:""});var et=class a{constructor(t){this.app=t,this.tables={},this.ignore={}}bind(t=null){if(t!==null&&typeof this.ignore[t]>"u"){this.bindTable(t);return}let e=document.getElementsByTagName("table"),n=e?e.length:0;for(let i=0;i<n;++i){let r=e[i].getAttribute("id");typeof r<"u"&&r!==null&&typeof this.ignore[r]>"u"&&this.bindTable(r)}}bindTable(t=null){if(t===null){u.Log.Logger.instance.info("A table doesn't have an ID.");return}this.tables[t]=new tt(t),this.bindExport(this.tables[t]);let e=this.tables[t].getSorting(),n=e.length;for(let o=0;o<n;++o)this.bindSorting(e[o],t);let i=this.tables[t].getFilter();n=i.length;for(let o=0;o<n;++o)this.bindFiltering(i[o],t);let r=this.tables[t].getCheckboxes();n=r.length;for(let o=0;o<n;++o)this.bindCheckbox(r[o],t);let s=this.tables[t].getHeader();this.bindColumnVisibility(s,t)}bindExport(t){let e=t.getExport();typeof e>"u"||e===null||e.addEventListener("click",function(n){window.omsApp.logger.log(t.serialize())})}bindColumnVisibility(t){let e=this,n=t.querySelectorAll("td"),i=n.length;for(let r=0;r<i;++r){let s=JSON.parse(window.localStorage.getItem("ui-state-"+this.id+"-header-"+r)),o=t.parentElement.getElementsByTagName("tr"),l=o.length;if(s==="1"&&!u.hasClass(n[r],"vh"))for(let c=0;c<l;++c){let d=o[c].getElementsByTagName("td");d.length<i||u.addClass(d[r],"vh")}else if((s==="0"||s===null)&&u.hasClass(n[r],"vh"))for(let c=0;c<l;++c){let d=o[c].getElementsByTagName("td");d.length<i||u.removeClass(d[r],"vh")}}t.addEventListener("contextmenu",function(r){if(u.preventAll(r),document.getElementById("table-ctx-menu")!==null)return;let s=document.getElementById("table-ctx-menu-tpl");if(s===null)return;let o=document.importNode(s.content,!0);s.parentNode.appendChild(o);let l=document.getElementById("table-ctx-menu"),c=t.querySelectorAll("td"),d=c.length,p=l.getElementsByClassName("context-line")[0].cloneNode(!0);for(let h=0;h<d;++h){if(c[h].firstElementChild.innerText.trim()==="")continue;let m=p.cloneNode(!0),A=m.firstElementChild.getAttribute("get")+h;m.firstElementChild.setAttribute("for",A),m.firstElementChild.firstElementChild.setAttribute("id",A),m.firstElementChild.appendChild(document.createTextNode(c[h].firstElementChild.innerText.trim()));let g=u.hasClass(c[h],"vh");l.getElementsByTagName("ul")[0].appendChild(m),l.querySelector("ul").lastElementChild.querySelector('input[type="checkbox"]').checked=!g,l.querySelector("ul").lastElementChild.querySelector('input[type="checkbox"]').addEventListener("change",function(){let w=t.parentElement.getElementsByTagName("tr"),y=w.length,b=u.hasClass(c[h],"vh");b?window.localStorage.setItem("ui-state-"+e.id+"-header-"+h,JSON.stringify("0")):window.localStorage.setItem("ui-state-"+e.id+"-header-"+h,JSON.stringify("1"));for(let E=0;E<y;++E){let C=w[E].getElementsByTagName("td");b?u.removeClass(C[h],"vh"):u.addClass(C[h],"vh")}})}l.getElementsByTagName("ul")[0].removeChild(l.getElementsByClassName("context-line")[0]);let f=s.parentElement.getBoundingClientRect();l.style.top=r.clientY-f.top+"px",l.style.left=r.clientX-f.left+"px",document.addEventListener("click",a.hideMenuClickHandler)})}static hideMenuClickHandler(t){let e=document.getElementById("table-ctx-menu");!e.contains(t.target)&&(e.parentNode.removeChild(e),document.removeEventListener("click",a.hideMenuClickHandler))}bindSorting(t,e){t.addEventListener("click",function(n){if(this.firstElementChild===null||this.firstElementChild.tagName.toLowerCase()==="a")return;let i=document.getElementById(e),r=i.getElementsByTagName("tbody")[0].rows,s=r.length,o=this.closest("td").cellIndex,l=u.hasClass(this,"sort-asc")?1:-1,c,d,p,f,h,m,A=!1,g=!1,w=this.closest("td").getAttribute("data-name");if(i.setAttribute("data-sorting",(l>0?"+":"-")+(w!==null?w:o)),i.getAttribute("data-src")!==null){a.getRemoteData(i);return}do{for(A=!1,c=0;c<s-1;++c){for(g=!1,p=r[c].getElementsByTagName("td")[o],h=p.getAttribute("data-content")!==null?p.getAttribute("data-content").toLowerCase():p.textContent.toLowerCase(),h=isNaN(h)?isNaN(new Date(h))?h:new Date(h):parseFloat(h),d=c+1;d<s;++d)if(f=r[d].getElementsByTagName("td")[o],m=f.getAttribute("data-content")!==null?f.getAttribute("data-content").toLowerCase():f.textContent.toLowerCase(),m=isNaN(m)?isNaN(new Date(m))?m:new Date(m):parseFloat(m),l===1&&h>m){g=!0;break}else if(l===-1&&h<m){g=!0;break}if(g===!0)break}g&&(r[c].parentNode.insertBefore(r[d],r[c]),A=!0)}while(A)})}bindFiltering(t,e){t.addEventListener("click",function(n){})}bindCheckbox(t,e){t.addEventListener("click",function(n){let i=t.closest("td").cellIndex,r=t.closest("table").querySelectorAll("tbody tr"),s=r.length,o=t.checked;for(let l=0;l<s&&!(typeof r[l].cells[i]>"u");++l){let c=r[l].cells[i].querySelector("input[type=checkbox]");c!==null&&(c.checked=o)}})}static getRemoteData(t){let e={limit:t.getAttribute("data-limit"),offset:t.getAttribute("data-offset"),sorting:t.getAttribute("data-sorting"),filter:t.getAttribute("data-filter")},n=new N;n.setData(e),n.setType(Nt.JSON),n.setUri(t.getAttribute("data-src")),n.setMethod("GET"),n.setRequestHeader("Content-Type","application/json"),n.setSuccess(function(i){a.emptyTable(t.getElementsByTagName("tbody")[0]),a.addToTable(t.getElementsByTagName("tbody")[0],JSON.parse(i.response)[0])}),n.send()}static emptyTable(t){let e=t.getElementsByTagName("tr"),n=e.length;for(let i=0;i<n;++i)e[i].parentNode.removeChild(e[i])}static addToTable(t,e){let n=e.length;console.table(e);for(let i=0;i<n;++i){let r=t.getElementsByTagName("template")[0].content.cloneNode(!0),s=r.querySelectorAll("[data-tpl-text]"),o=s.length;for(let l=0;l<o;++l)s[l].appendChild(document.createTextNode(u.getArray(s[l].getAttribute("data-tpl-text"),e[i])));s=r.querySelectorAll("[data-tpl-value]"),o=s.length;for(let l=0;l<o;++l)s[l].setAttribute("data-value",u.getArray(s[l].getAttribute("data-tpl-value"),e[i]));t.appendChild(r)}}};var nt=class{constructor(t){this.logger=v.getInstance(),this.app=t,this.actions={}}bind(t=null){let e=t==null?document.querySelectorAll("[data-action]"):typeof t.length<"u"?t:[t],n=e.length;for(let i=0;i<n;++i)e[i]!==null&&e[i].hasAttribute("data-action")&&this.bindElement(e[i])}bindElement(t){if(!u.isValidJson(t.getAttribute("data-action"))){this.logger.error("Invalid json string: '"+t.getAttribute("data-action")+"'");return}let e=JSON.parse(t.getAttribute("data-action")),n=e.length,i=this;for(let r=0;r<n;++r){let s=[t],o=!1;Object.prototype.hasOwnProperty.call(e[r],"selector")&&(s=document.querySelectorAll(e[r].selector),o=!0);let l=s.length;for(let d=0;d<l;++d)this.bindListener(s[d].id,e[r]);let c={childList:!1,attributes:!0,subtree:!1};o&&(this.app.eventManager.attach(t.id+"-childList",function(d){let p=d.addedNodes.length;for(let f=0;f<p;++f)i.bindListener(d.addedNodes[f].id,e[r],typeof e[r].autoremove<"u"?e[r].autoremove:!1)}),c.childList=!0,c.subtree=!0),this.app.eventManager.attach(t.id+"-attributes",function(d){}),this.app.uiManager.getDOMObserver().observe(t,c)}}bindListener(t,e,n=!1){let i=this,r=e.action.length;for(let s=1;s<r;++s){if(typeof t>"u"||typeof e.key>"u"){this.logger.error("Invalid element id/key: "+t+"/"+e.key);return}if(this.app.eventManager.isAttached(t+"-"+e.key+"-"+e.action[s-1].key))return;this.app.eventManager.attach(t+"-"+e.key+"-"+e.action[s-1].key,function(o){i.runAction(t,e,e.action[s],o)},n,!0)}document.getElementById(t).addEventListener(e.listener,function(s){e.preventDefault&&u.preventAll(s),i.runAction(this.id,e,e.action[0],s)},!1)}runAction(t,e,n,i){let r=this;if(!Object.prototype.hasOwnProperty.call(this.actions,n.type)){this.logger.warning("Undefined action "+n.type);return}n.data=i,this.actions[n.type](n,function(s){r.app.eventManager.trigger(t+"-"+e.key+"-"+n.key,t,s)},t)}add(t,e){this.actions[t]=e}};var it=class{constructor(t){this.app=t,this.draggable={},this.dragging=null}bind(t=null){if(t!==null)this.bindElement(t);else{let e=document.querySelectorAll(".oms-dragcontainer"),n=e?e.length:0;for(let i=0;i<n;++i)this.bindElement(e[i])}}bindElement(t){let e=this;t&&(t.addEventListener("dragstart",function(n){e.dragging===null&&(e.dragging=n.target,n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/html",n.target.innerHTML))},!1),t.addEventListener("dragenter",function(n){let i=n.target.closest(".oms-dragcontainer "+this.children[this.children.length-1].tagName),r=Array.from(this.children).indexOf(i),s=Array.from(e.dragging.children).indexOf(e.dragging),o=this.querySelector(".oms-drag-placeholder");o!==null&&this.removeChild(o);let l=document.createElement(e.dragging.tagName);if(e.dragging.tagName.toLowerCase()==="tr"){let c=document.createElement("td");c.setAttribute("colspan",42),l.appendChild(c)}l.setAttribute("draggable","true"),u.addClass(l,"oms-drag-placeholder"),s<r?this.insertBefore(l,i.nextSibling):this.insertBefore(l,i)},!1),t.addEventListener("dragover",function(n){n.preventDefault(),n.dataTransfer.dropEffect="move"},!1),t.addEventListener("dragleave",function(n){n.preventDefault()},!1),t.addEventListener("dragend",function(n){n.preventDefault();let i=this.querySelector(".oms-drag-placeholder");i!==null&&(this.insertBefore(e.dragging,i),this.removeChild(i),e.dragging=null)},!1),t.addEventListener("drop",function(n){n.stopPropagation(),n.preventDefault()},!1))}};var rt=class{constructor(t){this.app=t}bind(t=null){if(t!==null){this.bindElement(t);return}let e=document.querySelectorAll(".oms-ordercontainer"),n=e?e.length:0;for(let i=0;i<n;++i)this.bindElement(e[i])}bindElement(t){t&&t.addEventListener("click",function(e){if(!u.hasClass(e.target,"order-up")&&!u.hasClass(e.target,"order-down"))return;u.preventAll(e);let n=t.children.length,i=e.target.closest(".oms-ordercontainer "+this.children[n-1].tagName),r=Array.from(t.children).indexOf(i),s=u.hasClass(e.target,"order-up")?1:-1;s===1&&r>0?t.insertBefore(t.children[r],t.children[r-1]):s===-1&&r<n&&t.insertBefore(t.children[r],t.children[r+2])},!1)}};var st=class a{constructor(t){this.app=t}bind(){let t=document.querySelectorAll(".oms-remotecontainer"),e=t?t.length:0;setInterval(function(){for(let n=0;n<e;++n){let i=t[n].getAttribute("data-remote-uri"),r=t[n],s=new N;s.setData({}),s.setType(L.JSON),s.setUri(i),s.setMethod(R.GET),s.setSuccess(function(o){let l=JSON.parse(o.response),c=l.length,d=null;for(let h=0;h<c;++h){let m=r.querySelectorAll(r.getAttribute("data-ui-element"));if(d=m.length-1<h?null:m[h],d===null||d.getAttribute("data-id")!==l[h].id){let A=r.getAttribute("data-add-tpl").split(","),g=A.length,w=[],y=[],b=[];for(let E=0;E<g;++E){b.push(document.querySelector(A[E]).content.cloneNode(!0));let C=b[E].firstElementChild;w=w.concat(C.hasAttribute("data-tpl-value")?C:Array.prototype.slice.call(C.querySelectorAll("[data-tpl-value]"))),y=y.concat(C.hasAttribute("data-tpl-text")?C:Array.prototype.slice.call(C.querySelectorAll("[data-tpl-text]")))}a.setRemoteData("text",y,l[h]),a.setRemoteData("value",w,l[h]);for(let E=0;E<g;++E)d===null?r.appendChild(b[E].firstElementChild):r.insertBefore(b[E].firstElementChild,d);continue}else if(d!==null&&d.getAttribute("data-id")===l[h].id){let A=[],g=[],w=d;A=A.concat(w.hasAttribute("data-tpl-value")?w:Array.prototype.slice.call(w.querySelectorAll("[data-tpl-value]"))),g=g.concat(w.hasAttribute("data-tpl-text")?w:Array.prototype.slice.call(w.querySelectorAll("[data-tpl-text]"))),a.setRemoteData("text",g,l[h]),a.setRemoteData("value",A,l[h])}}let p=t[n].querySelectorAll(t[n].getAttribute("data-ui-element")),f=p.length;for(let h=c;h<f;++h)r.removeChild(p[h])}),s.send()}},30*1e3)}static setRemoteData(t,e,n={}){let i=e.length;for(let r=0;r<i;++r){let s=e[r].hasAttribute("data-tpl-"+t+"-path")?e[r].getAttribute("data-tpl-"+t+"-path"):null;s!==null&&(t==="value"?O.setValueOfElement(e[r],u.getArray(s,n)):O.setTextOfElement(e[r],u.getArray(s,n)))}}};var ot=class{constructor(t){this.app=t}bind(t=null){if(t!==null){this.bindElement(t);return}let e=document.querySelectorAll(".oms-ui-state"),n=e?e.length:0;for(let i=0;i<n;++i)this.loadState(e[i]),this.bindElement(e[i]);for(let i=0;i<n;++i)this.loadState(e[i])}loadState(t){if(!t)return;let e=JSON.parse(window.localStorage.getItem("ui-state-"+t.id));switch(e=e!==null?e:{},t.tagName.toLowerCase()){case"input":(e==="1"&&!t.checked||e==="0"&&t.checked)&&t.click();break;case"div":t.scrollLeft=e.x,t.scrollTop=e.y,t.scrollTo({top:e.y,left:e.x});break;default:break}}bindElement(t){if(t)switch(t.tagName.toLowerCase()){case"input":t.addEventListener("change",function(e){this.getAttribute("type")==="checkbox"||this.getAttribute("type")==="radio"?window.localStorage.setItem("ui-state-"+this.id,JSON.stringify(this.checked?"1":"0")):window.localStorage.setItem("ui-state-"+this.id,JSON.stringify(this.value))});break;case"div":t.addEventListener("scroll",function(){window.localStorage.setItem("ui-state-"+this.id,JSON.stringify({x:this.scrollLeft,y:this.scrollTop}))});break;default:break}}};var at=class{constructor(t){this.app=t,this.formManager=new Z(this.app),this.tabManager=new _(this.app),this.tableManager=new et(this.app),this.actionManager=new nt(this.app),this.dragNDrop=new it(this.app),this.order=new rt(this.app),this.generalUI=new O(this.app),this.remoteData=new st(this.app),this.uiStateManager=new ot(this.app);let e=this;this.domObserver=new MutationObserver(function(n){let i=n.length;for(let r=0;r<i;++r)e.app.eventManager.trigger(n[r].target.id+"-"+n[r].type,0,n[r])})}bind(t=null){if(t===null){this.formManager.bind(),this.tabManager.bind(),this.tableManager.bind(),this.actionManager.bind(),this.dragNDrop.bind(),this.order.bind(),this.generalUI.bind(),this.remoteData.bind(),this.uiStateManager.bind();return}let e=document.getElementById(t);if(this.generalUI.bind(e),!!e)switch(e.tagName){case"form":this.formManager.bind(t);break;case"table":this.tableManager.bind(t);break;default:this.actionManager.bind(e)}}getFormManager(){return this.formManager}getActionManager(){return this.actionManager}getDragNDrop(){return this.dragNDrop}getOrder(){return this.order}getRemoteData(){return this.remoteData}getUIStatemanager(){return this.uiStateManager}getTabManager(){return this.tabManager}getTableManager(){return this.tabManager}getDOMObserver(){return this.domObserver}getGeneralUI(){return this.generalUI}};var lt=class{constructor(){this.elements={},this.down=[]}add(t,e,n){typeof this.elements[t]>"u"&&(this.elements[t]=[],this.bind(t)),this.elements[t].push({keys:e,callback:n})}bind(t){let e=this,n=t===""?[document]:document.querySelectorAll(t),i=n.length;for(let r=0;r<i;++r)n[r].addEventListener("keydown",function(s){e.down.includes(s.keyCode)||(e.down.push(s.keyCode),e.run(t,s))}),n[r].addEventListener("keyup",function(s){let o=e.down.indexOf(s.keyCode);for(;o>-1;)e.down.splice(o,1),o=e.down.indexOf(s.keyCode)})}run(t,e){if(typeof this.elements[t]>"u")throw new Error("Unexpected element!");let n=this.elements[t].concat(this.elements[""]),i=n.length,r=this.down.length;for(let s=0;s<i;++s){let o=n[s].keys.length,l=!0;for(let c=0;c<o;++c)if(this.down.indexOf(n[s].keys[c])===-1){l=!1;break}if(l){for(let c=0;c<r;++c)if(n[s].keys.indexOf(this.down[c])===-1){l=!1;break}}if(l){u.preventAll(e),n[s].callback(e);break}}}};var D=Object.freeze({CONTEXT:0,LONGPRESS:1,CLICK:2});var ct=class{constructor(){this.elements={},this.click={time:0}}add(t,e,n,i,r){typeof this.elements[t]>"u"&&(this.elements[t]=[]),this.bind(t,e),this.elements[t].push({callback:i,type:e,button:n,exact:r})}bind(t,e){let n=this,i=document.getElementById(t);i&&(e===D.CONTEXT?i.addEventListener("contextmenu",function(r){n.run(t,r)},!1):e===D.LONGPRESS?(i.addEventListener("mousedown",function(r){n.click.time=new Date().getTime()},!1),i.addEventListener("mouseup",function(r){new Date().getTime()-n.click.time>650&&n.run(t,r),n.click.time=0},!1)):e===D.CLICK&&i.addEventListener("click",function(r){n.run(t,r)},!1))}run(t,e){if(typeof this.elements[t]>"u")throw new Error("Unexpected element!");let n=this.elements[t],i=n.length;for(let r=0;r<i;++r)(!n[r].exact||e.target.getAttribute("id")===t)&&n[r].button===e.button&&(u.preventAll(e),n[r].callback())}};var H=class{constructor(t,e={},n="en-US"){this.app=t,this.commands=e,this.lang=n,this.recognition=null,this.speechRecognitionList=null,j!==null&&(this.recognition=new j,this.speechRecognitionList=new Et)}setup(){if(j===null)return;let t=this;this.recognition.lang=this.lang,this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.continuous=!0,this.recognition.lang=this.lang,typeof this.commands<"u"&&(this.speechRecognitionList.addFromString(this.getCommandsString(),1),this.recognition.grammars=this.speechRecognitionList),this.recognition.onstart=function(){},this.recognition.onresult=function(e){let n=u.trim(e.results[e.resultIndex][0].transcript),i=Object.keys(t.commands);for(let r of i)n.startsWith(r)&&t.commands[r](n.substr(r.length).trim())},this.recognition.onspeechend=function(){},this.recognition.onnomatch=function(e){v.instance.warning("Couldn't recognize speech")},this.recognition.onerror=function(e){v.instance.warning("Error during speech recognition: "+e.error)}}getCommandsString(){return"#JSGF V1.0; grammar phrase; public <phrase> = "+Object.keys(this.commands).join(" | ")+" ;"}setLanguage(t){this.recognition.lang=t}add(t,e){this.commands[t]=e}start(){j!==null&&this.recognition.start()}stop(){j!==null&&this.recognition.stop()}},j=typeof j<"u"?j:typeof webkitSpeechRecognition<"u"?webkitSpeechRecognition:null,Et=typeof Et<"u"?Et:typeof webkitSpeechGrammarList<"u"?webkitSpeechGrammarList:null;var ut=class{constructor(t){this.keyboardManager=new lt,this.mouseManager=new ct,this.voiceManager=new H(t)}getKeyboardManager(){return this.keyboardManager}getMouseManager(){return this.mouseManager}getVoiceManager(){return this.voiceManager}};var dt=class{static getInstance(t,e){return new window.omsApp.Modules[t](e)}};var mt=class{constructor(t){this.modules={},this.app=t}get(t){return typeof this.modules[t]>"u"&&(this.modules[t]=dt.getInstance(t,this.app)),this.modules[t]}};var ft=class{constructor(t="en-US"){this.pitch=1,this.rate=1,this.lang=t,this.voices=[],this.voice=null,vt!==null&&(this.voices=window.speechSynthesis.getVoices(),this.voice=this.voices[0])}read(t){let e=new SpeechSynthesisUtterance(t);e.lang=this.lang,e.voice=this.voice,e.pitch=this.pitch,e.rate=this.rate,window.speechSynthesis.speak(e)}setLanguage(t){this.lang=t}setPitch(t){this.pitch=t}setRate(t){this.rate=t}getVoices(){return this.voices}},vt=typeof vt<"u"?vt:typeof webkitSpeechRecognition<"u"?webkitSpeechRecognition:null;var pt=class{constructor(){this.status=0}setStatus(t){this.status=t}send(t){let e=document.getElementById("app-message-tpl");if(e===null)return;switch(t.status){case 0:t.status=I.OK;break}let n=document.importNode(e.content,!0);if(n.querySelector(".log-msg").classList.add("log-lvl-"+t.status),n.querySelector(".log-msg-content").innerHTML=t.message,n.querySelector(".close").addEventListener("click",function(){this.parentNode.remove()}),t.title&&t.title!==""?n.querySelector(".log-msg-title").innerHTML=t.title:n.querySelector(".log-msg-title").remove(),t.primaryButton){let s=n.querySelector(".primary-button");s&&(s.innerHTML=t.primaryButton.text,s.addEventListener("click",t.primaryButton.callback))}else{let s=n.querySelector(".primary-button");s&&s.remove()}if(t.secondaryButton){let s=n.querySelector(".secondary-button");s&&(s.innerHTML=t.secondaryButton.text,s.addEventListener("click",t.secondaryButton.callback))}else{let s=n.querySelector(".secondary-button");s&&s.remove()}e.parentNode.appendChild(n);let i=document.getElementsByClassName("log-msg"),r=i[i.length-1];window.navigator.vibrate(t.vibrate?200:0),!t.isSticky&&setTimeout(function(){r!==null&&r.parentNode!==null&&r.parentNode.removeChild(r)},t.duration)}};var ht=class{constructor(){this.status=0}setStatus(t){this.status=t}requestPermission(){Notification.permission!=="granted"&&Notification.permission!=="denied"&&window.isSecureContext&&Notification.requestPermission()}send(t){Notification.permission==="granted"&&navigator.serviceWorker.ready.then(e=>{e.showNotification(t.title,{body:t.message,icon:"../images/touch/chrome-touch-icon-192x192.png",vibrate:[t.vibrate?200:0],tag:"notification"})})}};var gt=class{constructor(){this.appNotifier=new pt,this.browserNotifier=new ht}send(t,e){T.APP_NOTIFICATION===e?this.appNotifier.send(t):this.browserNotifier.send(t)}getAppNotifier(){return this.appNotifier}getBrowserNotifier(){return this.browserNotifier}};function yt(a,t,e){setTimeout(function(){let n=a.uri===""?"":S.build(a.uri);a.src?document.getElementById(a.src).src=n:n===window.location.href||n===""?document.location.reload():window.location.href=n},parseInt(a.delay))}function Ot(a,t,e){"use strict";a.uri===""&&(a.uri=document.getElementById(e).href);let n=new N(a.uri,a.method,a.request_type);n.setSuccess(function(i){window.omsApp.logger.log(i.responseText),t(JSON.parse(i.responseText))}),typeof a.data<"u"&&a.data!==null&&n.setData(a.data),n.send()}function Lt(a,t,e){"use strict";window.omsApp.notifyManager.send(new x(a.data[0].status,a.data[0].title,a.data[0].message),T.APP_NOTIFICATION),typeof t=="function"&&t()}function xt(a,t,e){"use strict";window.omsApp.logger.log("prevented"),u.preventAll(a.data),typeof t=="function"&&t()}function Tt(a,t,e){"use strict";a.key=a.jump-1,t()}function It(a,t,e){"use strict";let n=a.conditions,i=Object.values(a.data)[0];for(let r in n)if(n[r].comp==="=="&&i===n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp==="!="&&i!==n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp===">"&&i>n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp==="<"&&i<n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp===">="&&i>=n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp==="<="&&i<=n[r].value){a.key=n[r].jump-1;break}else if(n[r].comp===""){a.key=n[r].jump-1;break}typeof t=="function"&&t()}function kt(a,t,e){"use strict";let n=a.base==="self"?a.selector===""?[document.getElementById(e)]:document.getElementById(e).querySelectorAll(a.selector):document.querySelectorAll(a.selector);if(n){for(let i of n)i.click();typeof t=="function"&&t()}}function qt(a,t,e){"use strict";let n=a.base==="self"?a.selector===""||typeof a.selector>"u"?[document.getElementById(e)]:document.getElementById(e).querySelectorAll(a.selector):document.querySelectorAll(a.selector),i={};for(let r in n){if(!Object.prototype.hasOwnProperty.call(n,r)||!(n[r]instanceof HTMLElement))continue;let s=typeof n[r].getAttribute("name")<"u"&&n[r].getAttribute("name")!==""&&n[r].getAttribute("name")!==null?n[r].getAttribute("name"):n[r].getAttribute("id");if(n[r].tagName.toLowerCase()==="form"){i=window.omsApp.uiManager.getFormManager().get(s).getData();break}else i[s]=O.getValueFromDataSource(n[r])}t(i)}function Rt(a,t,e){"use strict";let n=a.value,i="",r="",s="",o=0,l=0;for(;n.indexOf("http")!==0&&(o=n.indexOf("{",o))!==-1;)l=n.indexOf("}",o),o++,i=n.substring(o,l),r=u.getArray(i,a.data,"/"),s="{"+i+"}",n=n.replace(new RegExp(s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),r);let c=a.base==="self"?a.selector===""?[document.getElementById(e)]:document.getElementById(e).querySelectorAll(a.selector):document.querySelectorAll(a.selector);for(let d in c)!Object.prototype.hasOwnProperty.call(c,d)||!(c[d]instanceof HTMLElement)||(c[d].tagName.toLowerCase()==="div"||c[d].tagName.toLowerCase()==="span"?c[d].innerHTML.includes(n)||(a.overwrite?c[d].innerHTML=n:a.overwrite||(c[d].innerHTML+=n)):c[d].tagName.toLowerCase()==="iframe"?c[d].src=S.build(n):c[d].value!==n&&!c[d].value.includes(", "+n+",")&&!c[d].value.endsWith(", "+n)&&!c[d].value.startsWith(n+",")&&(a.overwrite?c[d].value=n:c[d].value+=(c[d].value!==""?", ":"")+n));t(a.data)}function Mt(a,t,e){"use strict";let n=a.base==="self"?a.selector===""?[document.getElementById(e)]:document.getElementById(e).querySelectorAll(a.selector):document.querySelectorAll(a.selector);for(let i in n)if(!(!Object.prototype.hasOwnProperty.call(n,i)||!(n[i]instanceof HTMLElement)))switch(a.subtype){case"remove":{let r=n[i].getAttribute(a.attr);if(r!==null&&r.match(new RegExp("(\\s|^)"+a.value+"(\\s|$)"))!==null){let s=new RegExp("(\\s|^)"+a.value);n[i].setAttribute(a.attr,r.replace(s,"").trim())}break}case"add":n[i].setAttribute(a.attr,u.trim(n[i].getAttribute(a.attr)+" "+a.value));break;case"set":n[i].setAttribute(a.attr,a.value);break;default:}t(a.data)}function Ft(a,t,e){"use strict";let n=a.base==="self"?a.selector===""?[document.getElementById(e)]:document.getElementById(e).querySelectorAll(a.selector):document.querySelectorAll(a.selector);if(!n)return;let i=window.omsApp.uiManager.getFormManager();for(let r of n)i.submit(i.get(r.id));typeof t=="function"&&t()}var bt={redirect:yt,"message.request":Ot,"message.log":Lt,"dom.click":kt,"form.submit":Ft,"event.prevent":xt,"dom.get":qt,"dom.set":Rt,"dom.attr.change":Mt,jump:Tt,if:It};var J=[{element:"",keys:[17,80],callback:function(a){document.getElementById("iSearchBox").focus()}},{element:"",keys:[17],callback:async function(a){let t=document.querySelector("[data-preview]:hover"),e=document.getElementById("hover-preview-checkbox");if(t===null){e.checked=!1;return}let n=document.getElementById("hover-preview"),i=t.getBoundingClientRect(),r=t.getAttribute("data-preview");if(r)try{let o=await(await fetch(r,{mode:"cors"})).text();n.innerHTML=o;let l=n.getBoundingClientRect();if((l.left<i.left&&l.right>i.left||l.left>i.left&&l.left<i.right)&&(l.top<i.top&&l.bottom>i.top||l.top>i.top&&l.top<i.bottom)){let c=l.top<i.top?i.top-l.height-20:i.bottom+20;c<0?c=i.bottom+20:c+l.height>window.innerHeight&&(c=i.top-l.height-20),n.style.top=parseInt(c)+"px"}e.checked=!0}catch(s){console.error("Error fetching content:",s.message)}}},{element:"form, input, textarea, select",keys:[17,13],callback:function(a){let t=document.activeElement,e=t.closest("form");if(e!==null&&(e=e.id),e===null&&(e=t.getAttribute("form")),e===null&&(e=t.getAttribute("data-form")),e===null)return;let i=window.omsApp.uiManager.getFormManager().get(e).getSubmit(),r=i.length,s=-1;for(let o=0;o<r;++o)if(!u.hasClass(i[o],"vh")){if(u.hasClass(i[o],"add-form")||u.hasClass(i[o],"update-form")||u.hasClass(i[o],"save-form")){i[o].click();break}s=o}s!==-1&&i[s].click()}},{element:"label, tr",keys:[13],callback:function(a){document.activeElement.click()}},{element:"",keys:[17,66],callback:function(a){window.history.back()}},{element:"",keys:[17,40],callback:function(a){let t=document.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])'),e=t.length;for(let n=0;n<e;++n)if(document.activeElement===t[n]){let i=1;do n+i<e?t[n+i].focus():t[0+i-1].focus(),++i;while(i<e&&document.activeElement===t[n]);return}document.dispatchEvent(new KeyboardEvent("keypress",{keyCode:9}))}},{element:"",keys:[17,38],callback:function(a){let t=document.querySelectorAll('button, input, select, textarea, [tabindex]:not([tabindex="-1"])'),e=t.length;for(let n=0;n<e;++n)if(document.activeElement===t[n]){let i=1;do n-i+1>0?t[n-i].focus():t[e-i].focus(),++i;while(i<e&&document.activeElement===t[n]);return}document.dispatchEvent(new KeyboardEvent("keypress",{keyCode:9}))}}];var St=Object.freeze({LEFT:0,MIDDLE:1,RIGHT:2});var P=[{element:"nav-side",type:D.CONTEXT,button:St.RIGHT,callback:function(){window.omsApp.logger.log("right clicked")},exact:!0},{element:"nav-side",type:D.LONGPRESS,button:St.LEFT,callback:function(){window.omsApp.logger.log("left clicked")},exact:!1}];function Bt(a){let t=new x(a.level,a.title,a.msg);t.duration=5e3,window.omsApp.notifyManager.send(t,T.APP_NOTIFICATION)}function Dt(a){if(!document.getElementById(a.form))return;let e=document.getElementsByClassName("i-"+a.form);for(;e.length>0;)e[0].parentNode.removeChild(e[0]);a.errors.forEach(function(n){let i=document.getElementById(n.id);if(!i)return;let r=document.createElement("i"),s=document.createTextNode(n.msg);r.id="i-"+n.id,r.class="i-"+a.form,r.appendChild(s),i.parentNode.insertBefore(r,i.nextSibling)})}var At={notify:Bt,validation:Dt,redirect:yt};var wt={read:"read_text",help:function(){v.instance.debug("There is no help for you.")},"go to":function(a){let t=new N;t.setData({}),t.setType(L.FORM_DATA),t.setUri("api/navigation/goto?app=Backend&search="+a),t.setMethod(R.GET),t.setSuccess(function(e){window.omsApp.logger.log(e.response);try{let n=JSON.parse(e.response)[0],i=new U(n);typeof i.get("type")<"u"?window.omsApp.responseManager.run(i.get("type"),i.get(),t):typeof n.status<"u"&&n.status!==I.HIDDEN&&window.omsApp.notifyManager.send(new x(n.status,n.title,n.message),T.APP_NOTIFICATION)}catch(n){window.omsApp.logger.log(n),v.instance.error(`Invalid form response. 
Request: `+JSON.stringify(a)+`
Response: `+e.response)}}),t.setResultCallback(0,function(e){window.omsApp.notifyManager.send(new x(I.ERROR,"Failure","Some failure happened"),T.APP_NOTIFICATION)}),t.send()}};var Ct=class{constructor(){this.logger=v.getInstance(!0,!1,!1),window.logger=this.logger,this.cacheManager=new z,this.storageManager=new Q,this.eventManager=new X,this.responseManager=new $,this.assetManager=new K,this.accountManager=new Y,this.uiManager=new at(this),this.inputManager=new ut(this),this.moduleManager=new mt(this),this.readManager=new ft,this.voiceManager=new H(this),this.notifyManager=new gt,this.request=null,this.state={hasChanges:!1},this.reInit(),this.setupGeolocation(),this.setupNotificationManager(),this.setupServiceWorker(),this.setResponseMessages(),this.setVoiceActions(),this.setActions(),this.setKeyboardActions(),this.setMouseActions(),this.setPopstate()}reInit(){this.request=new k(window.location.href),this.request.setRootPath(k.parseUrl(typeof document.getElementsByTagName("base")[0]<"u"?document.getElementsByTagName("base")[0].href:"").path),S.setupUriBuilder(this.request),S.setQuery("/lang",window.location.href.substr(this.request.getBase().length).split("/")[0]),this.uiManager.bind()}setPopstate(){window.addEventListener("popstate",function(t,e){window.location.href=window.location.href})}setupGeolocation(){"geolocation"in navigator&&window.isSecureContext&&navigator.geolocation.getCurrentPosition(t=>{})}setupNotificationManager(){this.notifyManager.browserNotifier.requestPermission()}setupServiceWorker(){"serviceWorker"in navigator&&window.isSecureContext&&navigator.serviceWorker.register("sw.min.js").then(function(t){self.periodicSync.register("get-latest-notification",{minInterval:60*1}).then(()=>{v.instance.warning("PeriodicSync registration worked.")}).catch(function(e){v.instance.warning("PeriodicSync registration failed.")})}).catch(function(t){v.instance.warning("ServiceWorker registration failed.")})}setResponseMessages(){for(let t in At)At.hasOwnProperty(t)&&this.responseManager.add(t,At[t])}setActions(){for(let t in bt)bt.hasOwnProperty(t)&&this.uiManager.getActionManager().add(t,bt[t])}setKeyboardActions(){let t=J.length;for(let e=0;e<t;e++)this.inputManager.getKeyboardManager().add(J[e].element,J[e].keys,J[e].callback)}setMouseActions(){let t=P.length;for(let e=0;e<t;e++)this.inputManager.getMouseManager().add(P[e].element,P[e].type,P[e].button,P[e].callback,P[e].exact)}setVoiceActions(){for(let t in wt)wt.hasOwnProperty(t)&&this.voiceManager.add(t,wt[t]);this.voiceManager.setup(),this.voiceManager.start()}};u.ready(function(){"use strict";window.omsApp=new Ct});})();
/**
 * Standard library
 *
 * This library provides useful functionalities for the DOM and other manipulations.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Asset manager.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Log Level enum.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Http Uri.
 *
 * This class is for creating, modifying and analyzing http uris.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Form view.
 *
 * The form view contains a single form and it's data elements. Form actions are no longer handled by
 * the browser but through this view. The view also provides additional functionality for non-default
 * form elements such as canvas etc.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @todo On change listener
 *      Allow to add a on change listener in a form. This should result in automatic submits after changing a form.
 *      Consider the following cases to submit the form:
 *          * on Enter (all except textarea)
 *          * on Change (by using a timer)
 *          * on Leave (all elements)
 *      The listener should be defined in the form definition once and in js be applied to all form elements.
 *      https://github.com/Karaka-Management/jsOMS/issues/60
 */
/**
 * Uri factory.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Http request method.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Request type enum.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Request class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @question Consider to completely remove and replace with fetch
 */
/**
 * Request data enum.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * System utils class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Logger class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Request manager class.
 *
 * Used for pooling requests.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Response manager class.
 *
 * Used for auto handling different responses.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Account Manager.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Notification data enum.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * App notification message.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Advanced input class.
 *
 * @copyright  Dennis Eichhorn
 * @license    OMS License 2.0
 * @version    1.0.0
 * @since      1.0.0
 */
/**
 * Smart input class.
 *
 * @copyright  Dennis Eichhorn
 * @license    OMS License 2.0
 * @version    1.0.0
 * @since      1.0.0
 */
/**
 * UI manager for handling basic ui elements.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Form manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @todo Adding a template to the DOM should modify its id/generate a custom/random id for the added element
 *      for future handling as very often ids are required to identify and manage UI elements.
 *      https://github.com/Karaka-Management/jsOMS/issues/102
 *
 * @feature Auto update data changes in the backend (e.g. pull every x seconds, or use websockets for push)
 *      https://github.com/Karaka-Management/Karaka/issues/151
 */
/**
 * Tab manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Table view.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @todo Karaka/jsOMS#50
 *  Add basic table handling (no db and pagination)
 *
 * @todo Karaka/jsOMS#55
 *  Implement filtering and sorting based on backend
 *
 * @todo Karaka/jsOMS#57
 *  Advanced filtering
 *  The current filtering implementation is only column by column connected with &&.
 *  Consider to implement a much more advanced filtering where different combinations are possible such as || &&, different ordering with parenthesis etc.
 *  This can be extremely powerful but will be complex for standard users.
 *  This advanced filtering should probably be a little bit hidden?
 *
 * @todo Karaka/jsOMS#59
 *  Data download
 *  There is a small icon in the top right corner of tables which allows (not yet to be honest) to download the data in the table.
 *  Whether the backend should be queried for this or only the frontend data should be collected (current situation) should depend on if the table has an api endpoint defined.
 */
/**
 * Response type enum.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Table manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @feature Karaka/jsOMS#55
 *      Implement filtering and sorting based on backend
 *
 * @feature Karaka/jsOMS#57
 *      Advanced filtering
 *      The current filtering implementation is only column by column connected with &&.
 *      Consider to implement a much more advanced filtering where different combinations are possible such as || &&, different ordering with parenthesis etc.
 *      This can be extremely powerful but will be complex for standard users.
 *      This advanced filtering should probably be a little bit hidden?
 *
 * @feature Karaka/jsOMS#59
 *      Data download
 *      There is a small icon in the top right corner of tables which allows (not yet to be honest) to download the data in the table.
 *      Whether the backend should be queried for this or only the frontend data should be collected (current situation) should depend on if the table has an api endpoint defined.
 *
 * @feature Allow column drag/drop ordering which is also saved in the front end
 *
 * @feature Implement a filter highlight function.
 *      Either in forms or in tables, where the filter icon is highlighted, if a filter is defined.
 *      One solution could be to put an additional hidden filter checkbox in front of the filter icon and check for filter changes
 *      (bubble up) and then activate this hidden checkbox if a filter is defined.
 *      In CSS just define the filter icon as active/highlighted, if the hidden check box is active.
 *      This means we have two hidden checkboxes in front of the filter icon (one in case the filter menu is open = popup
 *      is visible and another one for highlighting the filter icon if a filter is defined).
 *      https://github.com/Karaka-Management/Karaka/issues/148
 *
 * @todo How to preserve form filter data to the next page?
 *      Not an issue, in the future we don't want to reload the whole page,
 *      but only exchange the table/list content with the backend response -> the header/filter will not get changed and
 *      remains as defined. This means for tables (maybe even forms?) to setup content replacement earlier than for other pages?!
 *      https://github.com/Karaka-Management/Karaka/issues/149
 */
/**
 * Action manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 *
 * @todo Karaka/jsOMS#26
 *  Sync/Async events
 *  Events so far can be created sync and async depending on the implementation.
 *  It would be better to make it sync/async depending on a option flag.
 *
 * @todo Karaka/jsOMS#35
 *  Template actions cannot be overwritten
 *  Templates by nature get added and removed from a page (often in order to reuse existing html to minimize the html load).
 *  The problem with templates is that they need to register in the ActionManager.js.
 *  A listener currently is only registered once per id.
 *  Since templates often keep the same id for some elements this results in a problem because the new template will not register a new listener.
 *  Possible solutions:
 *      1. Force unique ids for templates during setup (pro: fast and easy initial solution, con: action event pollution not solved)
 *      2. Whenever a dom element with action elements is removed, also unregister the listeners (pro: clean solution, con: difficult to implement)
 *  Solution 2 will be implemented.
 *  Maybe this can be performed in the dom removing action events or a dom listener would be required to listen for these dom elements.
 */
/**
 * Drag and drop class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Manual order class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Remote data class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * UI state manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Keyboard manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Event type.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Mouse manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Voice manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * UI manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Module factory.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Module manager.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Form manager class.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * App notification.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Browser notification.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Notification manager.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Click type.
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
/**
 * Application entry point
 *
 * @copyright Dennis Eichhorn
 * @license   OMS License 2.0
 * @version   1.0.0
 * @since     1.0.0
 */
